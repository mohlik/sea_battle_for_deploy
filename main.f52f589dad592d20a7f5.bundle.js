/*! For license information please see main.f52f589dad592d20a7f5.bundle.js.LICENSE.txt */
(()=>{var e,t={113:(e,t,i)=>{"use strict";i.d(t,{l:()=>ae});var s=i(260),a=i.n(s);class n extends a().GameObjects.Container{constructor(e,t){super(e),this.init(t)}init(e){let{atlas:t,frame_bg:i,frame_bar:s}=e;i&&(this.bg=new(a().GameObjects.Image)(this.scene,0,0,t||i,t?i:void 0),this.add(this.bg)),this.bar=new(a().GameObjects.Image)(this.scene,0,0,t||s,t?s:void 0),this.add(this.bar),this.update_progress(0)}update_progress(e){this.bar.setCrop(0,0,e*this.bar.width,this.bar.height)}}var o=i(823),l=i(238);const h="AI_LAYER_ACCESS_TOKEN";var r=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{h(s.next(e))}catch(e){n(e)}}function l(e){try{h(s.throw(e))}catch(e){n(e)}}function h(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}h((s=s.apply(e,t||[])).next())}))};function c(e){if(e.headers)return e.headers.Authorization=`Bearer ${localStorage.getItem(h)}`,e}function d(e){return r(this,void 0,void 0,(function*(){return e.data}))}function _(e){return r(this,void 0,void 0,(function*(){var t;const i=e.response;if(null===(t=e.config)||void 0===t?void 0:t.headers["Skip-Auth-Refresh"])return Promise.reject(null==i?void 0:i.data);if(401===(null==i?void 0:i.status)){const t=e.config;try{const e=yield b.refresh();return localStorage.setItem(h,e.data.accessToken),g.request(t)}catch(e){return Promise.reject(null==i?void 0:i.data)}}return Promise.reject(null==i?void 0:i.data)}))}var m=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{h(s.next(e))}catch(e){n(e)}}function l(e){try{h(s.throw(e))}catch(e){n(e)}}function h(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}h((s=s.apply(e,t||[])).next())}))};const g=new class{constructor(){this.entity=null,this.init()}init(){this.entity=l.Z.create({withCredentials:!0,baseURL:"https://ea96-188-163-109-21.ngrok-free.app"}),this.entity.interceptors.request.use(c),this.entity.interceptors.response.use(d,_)}request(e){return m(this,void 0,void 0,(function*(){try{return yield this.entity.request(e)}catch(e){return Promise.reject(e)}}))}get(e,t){return m(this,void 0,void 0,(function*(){return this.request(Object.assign(Object.assign({},t),{method:"GET",url:e}))}))}post(e,t,i){return m(this,void 0,void 0,(function*(){return this.request(Object.assign(Object.assign({},i),{method:"POST",url:e,data:t}))}))}put(e,t,i){return m(this,void 0,void 0,(function*(){return this.request(Object.assign(Object.assign({},i),{method:"PUT",url:e,data:t}))}))}delete(e,t){return m(this,void 0,void 0,(function*(){return this.request(Object.assign(Object.assign({},t),{method:"DELETE",url:e}))}))}login(e){return m(this,void 0,void 0,(function*(){return this.post("/v1/auth/sign-in",e)}))}};var p=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{h(s.next(e))}catch(e){n(e)}}function l(e){try{h(s.throw(e))}catch(e){n(e)}}function h(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}h((s=s.apply(e,t||[])).next())}))};class b{static refresh(){return p(this,void 0,void 0,(function*(){return g.post("/v1/auth/refresh-tokens")}))}static login(e){return p(this,void 0,void 0,(function*(){return g.post("/v1/auth/sign-in",e)}))}}class w{init(){const{initDataRaw:e}=(0,o.Y6U)();b.login(e),console.log(e)}}let f,u,y={width:0,height:0},x={cell_width:67,user_data:{name:"Player",rank:{stage:"sergant",score:890,to_up:1e3},rating:{score:999},coins:0,gems:0,oil:{amount:1e3,max:1e3},daily_reward:{amount:0},skills:{atom:{amount:0},bomber:{amount:0},fighter:{amount:0},torpedo:{amount:0},submarine:{amount:0},radar:{amount:0},airdef:{amount:0},mine:{amount:0}},statistic:{wins:0,loses:0},lang:"en_US",game_syles:{ships:"default",ava:"default",frame:"default",bg:"default"},flag:"UA",personalization:{avatars:["default","default","default","default","default","default","default","default"],frames:["default","default","default","default","default","default","default","default"],feet:["default","default"],backgrounds:["default","default"]}},personalization_data:{avatars:{default:{src:"",atlas:"",frame:""}}},shop:{personalization:{avatars:[{type:"avatar",price:100,valute:"gold"}]},purchase_items:[{type:"coins",id:"coin_1",price:.99,icon:"coin_1",items:{money:200}},{type:"coins",id:"coin_2",price:1.99,icon:"coin_2",items:{money:500}},{type:"coins",id:"coin_3",price:2.99,icon:"coin_3",items:{money:1100}},{type:"coins",id:"coin_4",price:3.99,icon:"coin_4",items:{money:2500}},{type:"coins",id:"coin_5",price:4.99,icon:"coin_5",items:{money:7e3}},{type:"gems",id:"gem_1",price:.99,icon:"gem_1",items:{gems:50}},{type:"gems",id:"gem_2",price:1.99,icon:"gem_2",items:{gems:110}},{type:"gems",id:"gem_3",price:2.99,icon:"gem_3",items:{gems:250}},{type:"gems",id:"gem_4",price:3.99,icon:"gem_4",items:{gems:600}},{type:"gems",id:"gem_5",price:4.99,icon:"gem_5",items:{gems:1500}}]},game_play:{with_bot:!0,advanced:!0,fields:[],default_rules:{ships:{boats:[4,3,2,1],bombs:0},filling:20}},skills:{atom:{price:300,max:1},bomber:{price:200,max:2},fighter:{price:150,max:3},torpedo:{price:150,max:2},submarine:{price:200,max:2},radar:{price:150,max:1},airdef:{price:120,max:3},mine:{price:50,max:4}},daily_rewards:[{type:"coins",amount:100,icon:"coin_1"},{type:"coins",amount:200,icon:"coin_1"},{type:"coins",amount:300,icon:"coin_1"},{type:"coins",amount:400,icon:"coin_1"},{type:"coins",amount:500,icon:"coin_1"},{type:"coins",amount:600,icon:"coin_1"},{type:"coins",amount:700,icon:"coin_1"},{type:"coins",amount:800,icon:"coin_1"},{type:"coins",amount:900,icon:"coin_1"},{type:"coins",amount:1e3,icon:"coin_1"},{type:"coins",amount:1100,icon:"coin_1"},{type:"coins",amount:1200,icon:"coin_1"},{type:"coins",amount:1300,icon:"coin_1"},{type:"coins",amount:1400,icon:"coin_1"}]};const O=1920,k=1080;class v extends a().Scene{constructor(){super("Boot")}preload(){this.load.plugin("rexshakepositionplugin","https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexshakepositionplugin.min.js",!0),this.load.image("loading_bg","assets/preload/loading_bg.png"),this.load.image("loader_bg","assets/preload/loader_bg.png"),this.load.image("loader_bar","assets/preload/loader_bar.png"),this.load.image("page_bg","assets/bgs/page_bg.png"),this.load.once("complete",this.create_loader,this)}create_loader(){let e=this.add.image(0,0,"loading_bg");e.setOrigin(0,0),e.setScale(y.width/e.width,y.height/e.height),this.loader=new n(this,{frame_bar:"loader_bar",frame_bg:"loader_bg"}),this.loader.x=y.width/2,this.loader.y=y.height/2,this.add.existing(this.loader),this.load.once("complete",(()=>{e.destroy(),this.loader.destroy(),this.create_game()})),this.preload_files()}preload_files(){this.load.on("progress",(e=>{this.loader.update_progress(e)})),this.load.pack("assets_pack","assets/assets_pack.json","images"),this.load.atlas("game_play","assets/game_play_atlas.png","assets/game_play_atlas.json"),this.load.atlas("new","assets/new_atlas.png","assets/new_atlas.json"),this.load.atlas("skill_anim","assets/skill_anim_atlas.png","assets/skill_anim_atlas.json"),this.load.atlas("game_menu","assets/game_menu.png","assets/game_menu.json"),this.load.atlas("shop","assets/shop.png","assets/shop.json"),this.load.atlas("flags","assets/flags.png","assets/flags.json"),this.load.json("map_items","assets/data/map_items.json"),this.load.font("rubik","assets/fonts/RubikMarkerHatch-Regular.ttf","truetype"),this.load.start()}create_game(){(new w).init(),u=new ae(this),this.add.existing(u),u.init()}get_game_size(){return{W:window.innerWidth,H:window.innerHeight}}set_game_size(){var e,t,i=document.querySelector("canvas");if(this&&this.scale.isFullscreen)e=window.innerWidth,t=window.innerHeight;else{var s=this.get_game_size();e=s.W,t=s.H}y.width=e,y.height=t;var a=1.7777777777777777;i&&(e/t<a?(i.style.width=e+"px",i.style.height=e/a+"px"):(i.style.height=t+"px",i.style.width=t*a+"px"))}update(e,t){var i;(null===(i=null==u?void 0:u.game_menu)||void 0===i?void 0:i.game_map)&&u.game_menu.game_map.update()}}const G={type:a().AUTO,width:O,height:k,parent:"phaser_game",backgroundColor:"#111111",scale:{mode:a().Scale.FIT,autoCenter:a().Scale.CENTER_BOTH},scene:[v]};f=new(a().Game)(G),y.width=O,y.height=k;class j extends a().GameObjects.Container{constructor(e,t){super(e),this.init(t)}init(e){this.clickable=!0,this.x=e.x,this.y=e.y,this.callback=e.callback;let{atlas:t,frame_out:i,frame_over:s,frame_down:n}=e,o=!1,l=!1;s||(o=!0,s=i),n||(l=!0,n=i),this.out_img=new(a().GameObjects.Image)(this.scene,0,0,t||i,t?i:void 0),this.over_img=new(a().GameObjects.Image)(this.scene,0,0,t||s,t?s:void 0),this.down_img=new(a().GameObjects.Image)(this.scene,0,0,t||n,t?n:void 0),this.add([this.out_img,this.over_img,this.down_img]),this.create_interactive(o,l)}create_interactive(e,t){this.out_img.setInteractive({useHandCursor:!0}),this.set_out(e||t),this.out_img.on("pointerdown",(()=>{this.clickable&&this.set_down(t)})),this.out_img.on("pointerover",(()=>{this.clickable&&this.set_over(e)})),this.out_img.on("pointerout",(()=>{this.clickable&&this.set_out(e||t)})),this.out_img.on("pointerup",(()=>{this.was_down&&(this.set_out(e||t),this.callback(this),this.was_down=!1)}))}set_handler(e){this.callback=e}setOrigin(e,t){t||0===t||(t=e),this.x-=(e-.5)*this.out_img.width,this.y-=(t-.5)*this.out_img.height}set_over(e){e||(this.over_img.visible=!0,this.down_img.visible=!1)}set_out(e){e?(this.over_img.visible=!1,this.down_img.visible=!1):(this.over_img.visible=!1,this.down_img.visible=!1,this.was_down=!1)}set_down(e){e||(this.over_img.visible=!1,this.down_img.visible=!0),this.was_down=!0}}class F extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.create_static_images(),this.create_texts(),this.create_rank_bar(),this.cerate_interactive_images()}show(){}create_static_images(){let e,t=x.cell_width;e=new(a().GameObjects.Image)(this.scene,7.5*t,3.5*t,"new","plank"),e.setScale(1.02,.98),this.add(e),e=new(a().GameObjects.Image)(this.scene,21.5*t,3.5*t,"new","plank"),e.setScale(1.02,.98),this.add(e),e=new(a().GameObjects.Image)(this.scene,7.5*t,14.5*t,"new","plank"),e.setScale(1.02,.98),this.add(e),e=new(a().GameObjects.Image)(this.scene,18.5*t,12.5*t,"new","plank"),e.setScale(.46,.98),this.add(e),e=new(a().GameObjects.Image)(this.scene,24.5*t,12.5*t,"new","plank"),e.setScale(.46,.98),this.add(e),e=new(a().GameObjects.Image)(this.scene,7.5*t,10*t,"new","name_back"),this.add(e);let i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),i.lineBetween(15*t,3*t+3.5,15*t,y.height),i.lineStyle(7,13582392,1),i.lineBetween(16*t,5*t,27*t,5*t),i.lineBetween(16*t,11*t,27*t,11*t),this.add(i)}create_texts(){let e,t=x.cell_width;e=new(a().GameObjects.Text)(this.scene,7.5*t,3.5*t,"INFORMATION",{fontFamily:"rubik",fontSize:36,color:"#ffffff"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,7.5*t,14.5*t,"UKRAINE",{fontFamily:"rubik",fontSize:36,color:"#ffffff"}),e.setOrigin(.5),e.setInteractive(),e.on("pointerup",(()=>{this.handler_edit_flag()})),this.add(e),e=new(a().GameObjects.Text)(this.scene,21.5*t,3.5*t,"STATISTICS",{fontFamily:"rubik",fontSize:36,color:"#ffffff"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,21.5*t,4.5*t,"FIGHTER STATISTIC",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,21.5*t,11.5*t,"MODE BATTLE STATISTIC",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,18.5*t,12.5*t,"CLASSIC",{fontFamily:"rubik",fontSize:28,color:"#ffffff"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,24.5*t,12.5*t,"ADVANCED",{fontFamily:"rubik",fontSize:28,color:"#ffffff"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,16*t+5,5.5*t,"SHIP SUNK:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,16*t+5,6.5*t,"CONSECUTIVE VICTORIES:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,16*t+5,7.5*t,"PERFECT VICTORIES:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,16*t+5,8.5*t,"VICTORIES IN TOURNAMENTS:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,16*t+5,9.5*t,"ADMIRALS DEFEATED:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,16*t+5,10.5*t,"FEET ADMIRALS DEFEATED:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,27*t-5,5.5*t,"89",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,27*t-5,6.5*t,"19",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,27*t-5,7.5*t,"9",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,27*t-5,8.5*t,"9",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,27*t-5,9.5*t,"92",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,27*t-5,10.5*t,"32",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,16*t+5,13.5*t,"BATTLES:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,21*t-5,13.5*t,"999",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,16*t,14.5*t,"W:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,18.35*t,14.5*t,"99%",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,18.8*t,14.5*t,"L:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,21*t,14.5*t,"1%",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,22*t+5,13.5*t,"BATTLES:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,27*t-5,13.5*t,"999",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,22*t,14.5*t,"W:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,24.35*t,14.5*t,"0%",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,24.8*t,14.5*t,"L:",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(0,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,27*t,14.5*t,"100%",{fontFamily:"rubik",fontSize:40,color:"#DF2C2A"}),e.setOrigin(1,.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,7.5*t,9.7*t,x.user_data.name.toUpperCase(),{fontFamily:"rubik",fontSize:36,color:"#051F79"}),e.setOrigin(.5),e.setInteractive(),e.on("pointerup",(()=>{this.handler_edit_name()})),this.add(e)}create_rank_bar(){let e,t=x.cell_width;this.rank_bar=new n(this.scene,{atlas:"new",frame_bg:"plank",frame_bar:"oil_progress"}),this.rank_bar.bg.setScale(.73,1),this.rank_bar.update_progress(x.user_data.rank.score/x.user_data.rank.to_up),this.rank_bar.setPosition(7.5*t,11.5*t),this.rank_bar.setScale(.9,1),this.add(this.rank_bar),e=new(a().GameObjects.Image)(this.scene,3.5*t+2,11.5*t+3,"new","rank_micro"),e.scale=1.6,this.add(e),this.rank_bar_txt=new(a().GameObjects.Text)(this.scene,7.5*t,11.5*t,`${x.user_data.rank.score}/${x.user_data.rank.to_up}`,{fontFamily:"rubik",fontSize:36,strokeThickness:4,stroke:"#072279"}),this.rank_bar_txt.setOrigin(.5,.5),this.add(this.rank_bar_txt)}cerate_interactive_images(){let e,t=x.cell_width;e=new(a().GameObjects.Image)(this.scene,7.5*t,6.6*t,"new","profile_ava"),e.scale=1.3,e.setInteractive(),e.on("pointerup",(()=>{this.handler_edit_ava()})),this.add(e),e=new(a().GameObjects.Image)(this.scene,12*t,4.5*t,"new","edit_icon"),e.setInteractive(),e.on("pointerup",(()=>{this.handler_edit_ava()})),this.add(e),e=new(a().GameObjects.Image)(this.scene,12*t,9.9*t,"new","edit_icon"),e.setInteractive(),e.on("pointerup",(()=>{this.handler_edit_name()})),this.add(e),e=new(a().GameObjects.Image)(this.scene,7.5*t,13.1*t,"new","edit_flag"),e.setInteractive(),e.on("pointerup",(()=>{this.handler_edit_flag()})),this.add(e),e=new(a().GameObjects.Image)(this.scene,11.1*t,11.5*t+3,"new","info_button"),e.setInteractive(),e.on("pointerup",(()=>{this.handler_rank_info()})),this.add(e)}handler_rank_info(){}handler_edit_ava(){u.big_windows.update_scenes("personalization")}handler_edit_name(){}handler_edit_flag(){u.big_windows.update_scenes("personalization")}handler_close(){}}class S extends a().GameObjects.Container{constructor(e,t){super(e),this.scene=e,this.init(t)}init(e){e.background?this.background=new(a().GameObjects.Image)(this.scene,0,0,e.background.texture?e.background.texture:e.background.frame,e.background.texture?e.background.frame:null).setOrigin(.5):this.background=new(a().GameObjects.Rectangle)(this.scene,0,0,e.width,e.height,16777215,0),e.scale&&this.background.setScale(e.scale.x,e.scale.y),e.tint&&this.background.setTint(e.tint),this.container=new(a().GameObjects.Container)(this.scene),this.add([this.background,this.container]),this.minus_y=this.background.getBounds().height/2*.95-20,this.minus_x=this.background.getBounds().width/2*.95;const{width:t,height:i}=this.background;this.setSize(t,i),this.setInteractive(),this.max_y=this.get_max_y()+20,this.was_move=!1,this.pointer_down=!1,this.on("pointerdown",(()=>{this.pointer_down=!0})).on("pointerup",(()=>{this.pointer_down=!1,this.was_move=!1})).on("pointerout",(()=>{this.pointer_down=!1,this.was_move=!1})).on("pointermove",(e=>{this.pointer_down&&(this.was_move=!0,this.updateScroll(e.position.y-e.prevPosition.y))})).on("wheel",((e,t,i)=>{this.updateScroll(.3*-i)}))}updateScroll(e){const t=this.container.y+e;t<-this.minus_y&&t>-this.max_y?this.container.y=t:t>-(this.max_y-this.minus_y)?this.container.y=-this.minus_y:t<-this.minus_y&&(this.container.y=-this.max_y),this.emit("scrollProgress",this.getScrollProgress())}get_max_y(){const e=[],t=(i,s=[])=>{i.list.forEach((i=>{if(i instanceof a().GameObjects.Container)s.push(i),t(i,s);else{const t=i;e.push(t.y+1.5*t.getBounds().height+s.reduce(((e,t)=>e+t.y),0))}}))};return t(this),Math.max(...e)}get_childs(){const e=[],t=i=>{i.list.forEach((i=>{"Container"===i.type?i instanceof a().GameObjects.Container&&t(i):e.push(i)}))};return t(this),e}get_last(){const e=this.get_childs();return e[e.map((e=>e.y)).indexOf(Math.max(...e.map((e=>e.y))))]}get_min_max_coords(){const e=this.get_childs(),t=e[e.map((e=>e.y)).indexOf(Math.min(...e.map((e=>e.y))))],i=e[e.map((e=>e.y)).indexOf(Math.max(...e.map((e=>e.y))))];return{min:t.y-t.getBounds().height/2,max:i.y+i.getBounds().height/2}}setXY(e,t,i,s){this.x=e,this.y=t,this.rect_mask=new(a().GameObjects.Rectangle)(this.scene,i||e,s||t,this.background.width,this.background.height,0,1),this.temp_mask=this.rect_mask.createGeometryMask(),this.container.mask=this.temp_mask,this.container.setPosition(-this.minus_x,-this.minus_y)}add_child(e,t){this.container.add(e),this.max_y=this.get_max_y()+(t||20)}replace_child(e,t){this.container.replace(e,t),this.max_y=this.get_max_y()+20}getScrollProgress(){const e=-this.minus_y,t=-this.max_y;return(this.container.y-t)/(e-t)}}class I extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.create_folders_buttons(),this.create_avatar_page(),this.create_frame_page(),this.create_feet_page(),this.create_flag_page(),this.create_background_page(),this.update_visible_page("avatar")}create_folders_buttons(){let e,t,i=x.cell_width;e=new(a().GameObjects.Image)(this.scene,4.5*i,3.5*i,"new","plank"),e.setScale(.37,1),this.add(e),t=new j(this.scene,{x:4.5*i,y:3.5*i,atlas:"new",frame_out:"plank_frame",callback:t=>{"avatar"==this.page_name||this.page_moving||(e.setPosition(t.x,t.y),this.update_visible_page("avatar"))}}),this.add(t),t=new j(this.scene,{x:9.6*i,y:3.5*i,atlas:"new",frame_out:"plank_frame",callback:t=>{"frame"==this.page_name||this.page_moving||(e.setPosition(t.x,t.y),this.update_visible_page("frame"))}}),this.add(t),t=new j(this.scene,{x:14.7*i,y:3.5*i,atlas:"new",frame_out:"plank_frame",callback:t=>{"feet"==this.page_name||this.page_moving||(e.setPosition(t.x,t.y),this.update_visible_page("feet"))}}),this.add(t),t=new j(this.scene,{x:19.8*i,y:3.5*i,atlas:"new",frame_out:"plank_frame",callback:t=>{"flag"==this.page_name||this.page_moving||(e.setPosition(t.x,t.y),this.update_visible_page("flag"))}}),this.add(t),t=new j(this.scene,{x:25*i,y:3.5*i,atlas:"new",frame_out:"plank_frame",callback:t=>{"background"==this.page_name||this.page_moving||(e.setPosition(t.x,t.y),this.update_visible_page("background"))}}),this.add(t)}update_visible_page(e){const t={avatar:this.avatar_page,frame:this.frame_page,feet:this.feet_page,flag:this.flag_page,background:this.background_page};this.page_moving=!0,this.current_page?this.scene.tweens.add({targets:this.current_page,alpha:0,duration:150,onComplete:()=>{this.current_page.visible=!1,this.page_name=e,this.current_page=t[this.page_name],this.current_page.visible=!0,this.scene.tweens.add({targets:this.current_page,alpha:1,duration:150,onComplete:()=>{this.page_moving=!1}})}}):(this.page_name=e,this.current_page=t[this.page_name],this.current_page.visible=!0,this.scene.tweens.add({targets:this.current_page,alpha:1,duration:200,onComplete:()=>{this.page_moving=!1}}))}create_avatar_page(){let e=x.cell_width;this.avatar_page=new(a().GameObjects.Container)(this.scene),this.avatar_page.alpha=0,this.avatar_page.visible=!1,this.add(this.avatar_page);let t,i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),i.lineBetween(0,5*e,y.width,5*e),i.lineBetween(y.width/2,5*e,y.width/2,16*e),i.lineBetween(y.width/2-e,5.5*e,y.width/2-e,15.5*e),i.lineBetween(26.5*e,5.5*e,26.5*e,15.5*e),this.avatar_page.add(i),t=new(a().GameObjects.Text)(this.scene,y.width/4,4.5*e,"YOU AVATARS",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),t.setOrigin(.5),this.avatar_page.add(t),t=new(a().GameObjects.Text)(this.scene,.75*y.width,4.5*e,"AVATARS",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),t.setOrigin(.5),this.avatar_page.add(t),t=new(a().GameObjects.Text)(this.scene,4.5*e,3.5*e,"AVATAR",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.avatar_page.add(t),t=new(a().GameObjects.Text)(this.scene,9.6*e,3.5*e,"FRAME",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.avatar_page.add(t),t=new(a().GameObjects.Text)(this.scene,14.7*e,3.5*e,"FEET",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.avatar_page.add(t),t=new(a().GameObjects.Text)(this.scene,19.8*e,3.5*e,"FLAG",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.avatar_page.add(t),t=new(a().GameObjects.Text)(this.scene,25*e,3.5*e,"BATTLEFIELD",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.avatar_page.add(t);let s=new S(this.scene,{width:11*e,height:11*e});this.avatar_page.add(s),s.setXY(y.width/4,y.height/2+2.5*e);let n=new(a().GameObjects.Image)(this.scene,y.width/2-e,5.5*e,"new","scroller");this.avatar_page.add(n),s.on("scrollProgress",(t=>{n.y=5.5*e+10*(1-t)*e}));let o,l=x.user_data.personalization.avatars;l.forEach(((t,i)=>{let n=i%2==0?8*e:3*e,l=i%2==0?2.8*e*(i-1):2.8*e*i;o=new(a().GameObjects.Image)(this.scene,n,l,"new","profile_ava"),s.add_child(o),o.y-=1.4*e,o.setInteractive(),o.on("pointerdown",(()=>{s.pointer_down=!0})),o.on("pointerup",(()=>{s.was_move?s.was_move=!1:this.handler_choose_ava(t),s.pointer_down=!1})),o.on("pointerout",(()=>{s.pointer_down=!1,s.was_move=!1})),o.on("pointermove",(e=>{s.emit("pointermove",e)})),o=new(a().GameObjects.Image)(this.scene,n,l+o.height/2,"new","blue_button"),s.add_child(o),o.scale=.8,o.y-=1*e,o.setInteractive(),o.on("pointerdown",(()=>{s.pointer_down=!0})),o.on("pointerup",(()=>{s.was_move?s.was_move=!1:this.handler_choose_ava("flag"),s.pointer_down=!1})),o.on("pointerout",(()=>{s.pointer_down=!1,s.was_move=!1})),o.on("pointermove",(e=>{s.emit("pointermove",e)}))}));let h=new S(this.scene,{width:11*e,height:11*e});this.avatar_page.add(h),h.setXY(20*e,y.height/2+2.5*e);let r=new(a().GameObjects.Image)(this.scene,26.5*e,5.5*e,"new","scroller");this.avatar_page.add(r),h.on("scrollProgress",(t=>{r.y=5.5*e+10*(1-t)*e})),l.forEach(((t,i)=>{let s=i%2==0?8*e:3*e,n=i%2==0?2.8*e*(i-1):2.8*e*i;o=new(a().GameObjects.Image)(this.scene,s,n,"new","profile_ava"),h.add_child(o),o.y-=1.4*e,o.setInteractive(),o.on("pointerdown",(()=>{h.pointer_down=!0})),o.on("pointerup",(()=>{h.was_move&&(h.was_move=!1),h.pointer_down=!1})),o.on("pointerout",(()=>{h.pointer_down=!1,h.was_move=!1})),o.on("pointermove",(e=>{h.emit("pointermove",e)})),o=new(a().GameObjects.Image)(this.scene,s,n+o.height/2,"new","blue_button"),h.add_child(o),o.scale=.8,o.y-=1*e,o.setInteractive(),o.on("pointerdown",(()=>{h.pointer_down=!0})),o.on("pointerup",(()=>{h.was_move?h.was_move=!1:this.handler_choose_ava("flag"),h.pointer_down=!1})),o.on("pointerout",(()=>{h.pointer_down=!1,h.was_move=!1})),o.on("pointermove",(e=>{h.emit("pointermove",e)}))}))}handler_choose_ava(e){}create_frame_page(){let e=x.cell_width;this.frame_page=new(a().GameObjects.Container)(this.scene),this.frame_page.alpha=0,this.frame_page.visible=!1,this.add(this.frame_page);let t,i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),i.lineBetween(0,5*e,y.width,5*e),i.lineBetween(y.width/2,5*e,y.width/2,16*e),i.lineBetween(y.width/2-e,5.5*e,y.width/2-e,15.5*e),i.lineBetween(26.5*e,5.5*e,26.5*e,15.5*e),this.frame_page.add(i),t=new(a().GameObjects.Text)(this.scene,y.width/4,4.5*e,"YOU FRAMES",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),t.setOrigin(.5),this.frame_page.add(t),t=new(a().GameObjects.Text)(this.scene,.75*y.width,4.5*e,"FRAMES",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),t.setOrigin(.5),this.frame_page.add(t),t=new(a().GameObjects.Text)(this.scene,4.5*e,3.5*e,"AVATAR",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.frame_page.add(t),t=new(a().GameObjects.Text)(this.scene,9.6*e,3.5*e,"FRAME",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.frame_page.add(t),t=new(a().GameObjects.Text)(this.scene,14.7*e,3.5*e,"FEET",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.frame_page.add(t),t=new(a().GameObjects.Text)(this.scene,19.8*e,3.5*e,"FLAG",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.frame_page.add(t),t=new(a().GameObjects.Text)(this.scene,25*e,3.5*e,"BATTLEFIELD",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.frame_page.add(t);let s=new S(this.scene,{width:11*e,height:11*e});this.frame_page.add(s),s.setXY(y.width/4,y.height/2+2.5*e);let n=new(a().GameObjects.Image)(this.scene,y.width/2-e,5.5*e,"new","scroller");this.frame_page.add(n),s.on("scrollProgress",(t=>{n.y=5.5*e+10*(1-t)*e}));let o,l=x.user_data.personalization.avatars;l.forEach(((t,i)=>{let n=i%2==0?8*e:3*e,l=i%2==0?2.8*e*(i-1):2.8*e*i;o=new(a().GameObjects.Image)(this.scene,n,l,"new","profile_ava"),s.add_child(o),o.y-=1.4*e,o.setInteractive(),o.on("pointerdown",(()=>{s.pointer_down=!0})),o.on("pointerup",(()=>{s.was_move?s.was_move=!1:this.handler_choose_ava(t),s.pointer_down=!1})),o.on("pointerout",(()=>{s.pointer_down=!1,s.was_move=!1})),o.on("pointermove",(e=>{s.emit("pointermove",e)}))}));let h=new S(this.scene,{width:11*e,height:11*e});this.frame_page.add(h),h.setXY(20*e,y.height/2+2.5*e);let r=new(a().GameObjects.Image)(this.scene,26.5*e,5.5*e,"new","scroller");this.frame_page.add(r),h.on("scrollProgress",(t=>{r.y=5.5*e+10*(1-t)*e})),l.forEach(((t,i)=>{let s=i%2==0?8*e:3*e,n=i%2==0?2.8*e*(i-1):2.8*e*i;o=new(a().GameObjects.Image)(this.scene,s,n,"new","profile_ava"),h.add_child(o),o.y-=1.4*e,o.setInteractive(),o.on("pointerdown",(()=>{h.pointer_down=!0})),o.on("pointerup",(()=>{h.was_move?h.was_move=!1:this.handler_choose_ava(t),h.pointer_down=!1})),o.on("pointerout",(()=>{h.pointer_down=!1,h.was_move=!1})),o.on("pointermove",(e=>{h.emit("pointermove",e)}))}))}create_feet_page(){let e=x.cell_width;this.feet_page=new(a().GameObjects.Container)(this.scene),this.feet_page.alpha=0,this.feet_page.visible=!1,this.add(this.feet_page);let t,i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),i.lineBetween(0,5*e,y.width,5*e),this.feet_page.add(i),t=new(a().GameObjects.Text)(this.scene,y.width/2,4.5*e,"CHOISE FEET!",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),t.setOrigin(.5),this.feet_page.add(t),t=new(a().GameObjects.Text)(this.scene,4.5*e,3.5*e,"AVATAR",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.feet_page.add(t),t=new(a().GameObjects.Text)(this.scene,9.6*e,3.5*e,"FRAME",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.feet_page.add(t),t=new(a().GameObjects.Text)(this.scene,14.7*e,3.5*e,"FEET",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.feet_page.add(t),t=new(a().GameObjects.Text)(this.scene,19.8*e,3.5*e,"FLAG",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.feet_page.add(t),t=new(a().GameObjects.Text)(this.scene,25*e,3.5*e,"BATTLEFIELD",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.feet_page.add(t)}create_flag_page(){let e=x.cell_width;this.flag_page=new(a().GameObjects.Container)(this.scene),this.flag_page.alpha=0,this.flag_page.visible=!1,this.add(this.flag_page);let t,i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),i.lineBetween(0,5*e,y.width,5*e),i.lineBetween(26.5*e,5.5*e,26.5*e,15.5*e),this.flag_page.add(i),t=new(a().GameObjects.Text)(this.scene,y.width/2,4.5*e,"CHOISE FLAG!",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),t.setOrigin(.5),this.flag_page.add(t),t=new(a().GameObjects.Text)(this.scene,4.5*e,3.5*e,"AVATAR",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.flag_page.add(t),t=new(a().GameObjects.Text)(this.scene,9.6*e,3.5*e,"FRAME",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.flag_page.add(t),t=new(a().GameObjects.Text)(this.scene,14.7*e,3.5*e,"FEET",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.flag_page.add(t),t=new(a().GameObjects.Text)(this.scene,19.8*e,3.5*e,"FLAG",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.flag_page.add(t),t=new(a().GameObjects.Text)(this.scene,25*e,3.5*e,"BATTLEFIELD",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.flag_page.add(t);let s=new S(this.scene,{width:24*e,height:11*e});this.flag_page.add(s),s.setXY(y.width/2,y.height/2+2.5*e);let n=new(a().GameObjects.Image)(this.scene,26.5*e,5.5*e,"new","scroller");this.flag_page.add(n),s.on("scrollProgress",(t=>{n.y=5.5*e+10*(1-t)*e})),x.user_data.personalization.avatars,x.flags.forEach(((i,n)=>{let o=n%5*e*4.5+2*e,l=Math.floor(n/5)*e*5+1.5*e,h=new(a().GameObjects.Image)(this.scene,o,l,"default_frame");s.add_child(h),h.setInteractive();let r=new(a().GameObjects.Image)(this.scene,o,l,"flags",i);r.setScale(.3),s.add_child(r),h.on("pointerdown",(()=>{s.pointer_down=!0})),h.on("pointerup",(()=>{s.was_move&&(s.was_move=!1),s.pointer_down=!1})),h.on("pointerout",(()=>{s.pointer_down=!1,s.was_move=!1})),h.on("pointermove",(e=>{s.emit("pointermove",e)})),h=new(a().GameObjects.Image)(this.scene,o,l+h.height/2+.4*e,"new",i!==x.user_data.flag?"lightblue_button":"blue_button"),h.scale=.8,h.setInteractive(),s.add_child(h),t=new(a().GameObjects.Text)(this.scene,h.x,h.y,"CHOOSE",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),s.add_child(t),h.text=t,h.on("pointerdown",(()=>{s.pointer_down=!0})),h.on("pointerup",(()=>{s.was_move?s.was_move=!1:i!==x.user_data.flag&&(h.text.destroy(),h.setFrame("blue_button"),x.user_data.flag=r.frame.name),s.pointer_down=!1})),h.on("pointerout",(()=>{s.pointer_down=!1,s.was_move=!1})),h.on("pointermove",(e=>{s.emit("pointermove",e)}))}))}create_background_page(){let e=x.cell_width;this.background_page=new(a().GameObjects.Container)(this.scene),this.background_page.alpha=0,this.background_page.visible=!1,this.add(this.background_page);let t,i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),i.lineBetween(0,5*e,y.width,5*e),this.background_page.add(i),t=new(a().GameObjects.Text)(this.scene,y.width/2,4.5*e,"CHOISE BATTLEFIELD!",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),t.setOrigin(.5),this.background_page.add(t),t=new(a().GameObjects.Text)(this.scene,4.5*e,3.5*e,"AVATAR",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.background_page.add(t),t=new(a().GameObjects.Text)(this.scene,9.6*e,3.5*e,"FRAME",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.background_page.add(t),t=new(a().GameObjects.Text)(this.scene,14.7*e,3.5*e,"FEET",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.background_page.add(t),t=new(a().GameObjects.Text)(this.scene,19.8*e,3.5*e,"FLAG",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.background_page.add(t),t=new(a().GameObjects.Text)(this.scene,25*e,3.5*e,"BATTLEFIELD",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.background_page.add(t)}show(){}handler_close(){}}class T extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.create_static_images(),this.create_texts(),this.create_volume_control(),this.create_fullscreen_control(),this.create_language_control(),this.create_privacy_policy()}show(){}create_static_images(){let e=x.cell_width,t=new(a().GameObjects.Graphics)(this.scene);t.lineStyle(7,335737,1),t.lineBetween(y.width/2-6*e,4.5*e,y.width/2+6*e,4.5*e),t.lineBetween(y.width/2-6*e,6.5*e,y.width/2+6*e,6.5*e),this.add(t)}create_texts(){let e,t=x.cell_width;e=new(a().GameObjects.Text)(this.scene,y.width/2,3.5*t,"MUSIC",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,y.width/2,5.5*t,"EFFECT AND VOICE",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,y.width/2,7.5*t,"SCREEN MODE",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,y.width/2,9.5*t,"LANGUAGE",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),e.setOrigin(.5),this.add(e)}create_language_control(){let e,t,i,s=x.cell_width;e=new(a().GameObjects.Image)(this.scene,y.width/2,10.5*s,"new","flag_micro"),e.scale=1.3,this.add(e),t=new(a().GameObjects.Text)(this.scene,y.width/2,11.5*s,"УКРАЇНСЬКА",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),t.setOrigin(.5),this.add(t),i=new j(this.scene,{x:y.width/2-3.5*s,y:11.5*s,atlas:"game_play",frame_out:"back_icon",callback:()=>{}}),this.add(i),i=new j(this.scene,{x:y.width/2+3.5*s,y:11.5*s,atlas:"game_play",frame_out:"back_icon",callback:()=>{}}),i.out_img.setFlipX(!0),this.add(i)}create_volume_control(){let e=x.cell_width,t=new(a().GameObjects.Image)(this.scene,y.width/2-6*e,4.55*e,"new","scroller");this.add(t),t.setInteractive({draggable:!0}),t.on("drag",((i,s,a)=>{s>y.width/2-6*e&&s<y.width/2+6*e&&(t.x=s)})),t.on("dragend",(()=>{}));let i=new(a().GameObjects.Image)(this.scene,y.width/2-6*e,6.55*e,"new","scroller");this.add(i)}create_fullscreen_control(){let e,t,i=x.cell_width;t=new j(this.scene,{x:y.width/2-3.5*i,y:8.5*i,atlas:"new",frame_out:"plank_frame",callback:()=>{this.handler_privacy_policy()}}),t.out_img.scaleX=1.25,e=new(a().GameObjects.Text)(this.scene,0,0,"WINDOW",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),e.setOrigin(.5),t.add(e),this.add(t),t=new j(this.scene,{x:y.width/2+3.5*i,y:8.5*i,atlas:"new",frame_out:"plank_frame",callback:()=>{this.handler_privacy_policy()}}),t.out_img.scaleX=1.25,e=new(a().GameObjects.Text)(this.scene,0,0,"FULLSCREEN",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),e.setOrigin(.5),t.add(e),this.add(t)}create_privacy_policy(){let e,t,i=x.cell_width;t=new j(this.scene,{x:y.width/2,y:13.5*i,atlas:"new",frame_out:"plank_frame",callback:()=>{this.handler_privacy_policy()}}),t.out_img.scaleX=1.5,e=new(a().GameObjects.Text)(this.scene,0,0,"PRIVACY POLICY",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),e.setOrigin(.5),t.add(e),this.add(t)}handler_privacy_policy(){}handler_close(){}}class z extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.create_folders_buttons(),this.create_rating_slider()}create_folders_buttons(){let e,t,i,s,n=x.cell_width;e=new(a().GameObjects.Image)(this.scene,11.5*n,3.5*n,"new","plank"),e.setScale(.6475,1),this.add(e),t=new(a().GameObjects.Image)(this.scene,4.5*n,5.5*n,"new","plank"),t.setScale(.4625,1),this.add(t),this.page_moving=!1;let o=[],l=[];s=new j(this.scene,{x:11.5*n,y:3.5*n,atlas:"new",frame_out:"plank_frame",callback:t=>{"avatar"==this.page_name||this.page_moving||(e.setScale(.37*t.scaleX,t.scaleY),e.setPosition(t.x,t.y),o.forEach((e=>e.setStyle({color:"#051F79"}))),o[0].setStyle({color:"#FFFFFF"}))}}),s.setScale(1.75,1),i=new(a().GameObjects.Text)(this.scene,s.x,s.y,"ONLINE MODE",{fontFamily:"rubik",fontSize:28,color:"#FFFFFF"}),o.push(i),i.setOrigin(.5),this.add(i),this.add(s),s=new j(this.scene,{x:20.5*n,y:3.5*n,atlas:"new",frame_out:"plank_frame",callback:t=>{"frame"==this.page_name||this.page_moving||(e.setScale(.37*t.scaleX,t.scaleY),e.setPosition(t.x,t.y),o.forEach((e=>e.setStyle({color:"#051F79"}))),o[1].setStyle({color:"#FFFFFF"}))}}),s.setScale(1.75,1),i=new(a().GameObjects.Text)(this.scene,s.x,s.y,"SINGLE MODE",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),o.push(i),i.setOrigin(.5),this.add(i),this.add(s),s=new j(this.scene,{x:4.5*n,y:5.5*n,atlas:"new",frame_out:"plank_frame",callback:e=>{"feet"==this.page_name||this.page_moving||(t.setScale(.37*e.scaleX,e.scaleY),t.setPosition(e.x,e.y),l.forEach((e=>e.setStyle({color:"#051F79"}))),l[0].setStyle({color:"#FFFFFF"}))}}),s.setScale(1.25,1),i=new(a().GameObjects.Text)(this.scene,s.x,s.y,"PER DAY",{fontFamily:"rubik",fontSize:28,color:"#FFFFFF"}),l.push(i),i.setOrigin(.5),this.add(i),this.add(s),s=new j(this.scene,{x:4.5*n,y:7.5*n,atlas:"new",frame_out:"plank_frame",callback:e=>{"flag"==this.page_name||this.page_moving||(t.setScale(.37*e.scaleX,e.scaleY),t.setPosition(e.x,e.y),l.forEach((e=>e.setStyle({color:"#051F79"}))),l[1].setStyle({color:"#FFFFFF"}))}}),s.setScale(1.25,1),i=new(a().GameObjects.Text)(this.scene,s.x,s.y,"IN A WEEK",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),l.push(i),i.setOrigin(.5),this.add(i),this.add(s),s=new j(this.scene,{x:4.5*n,y:9.5*n,atlas:"new",frame_out:"plank_frame",callback:e=>{"background"==this.page_name||this.page_moving||(t.setScale(.37*e.scaleX,e.scaleY),t.setPosition(e.x,e.y),l.forEach((e=>e.setStyle({color:"#051F79"}))),l[2].setStyle({color:"#FFFFFF"}))}}),s.setScale(1.25,1),i=new(a().GameObjects.Text)(this.scene,s.x,s.y,"FOR ALL TIME",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),l.push(i),i.setOrigin(.5),this.add(i),this.add(s)}create_rating_slider(){let e=x.cell_width,t=new S(this.scene,{width:18*e,height:10*e});this.add(t),t.setXY(16*e,10*e);let i=new(a().GameObjects.Image)(this.scene,y.width-2.1*e,5*e,"new","scroller");this.add(i),t.on("scrollProgress",(t=>{i.y=5.5*e+10*(1-t)*e}));let s,n,o=8.6*e;[{},{},{},{},{},{}].forEach(((i,l)=>{n=l*e,s=new(a().GameObjects.Rectangle)(this.scene,o,n+.5*e,18*e,7,335737),t.add_child(s)}))}show(){}handler_close(){}}class C extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.create_folders_buttons(),this.create_free_page(),this.create_coins_page(),this.create_gems_page(),this.create_promotion_page(),this.update_visible_page("free")}create_folders_buttons(){let e,t,i=x.cell_width;e=new(a().GameObjects.Image)(this.scene,5*i,3.5*i,"new","plank"),e.setScale(5/11,1),this.add(e),t=new j(this.scene,{x:5*i,y:3.5*i,atlas:"new",frame_out:"plank_frame",callback:t=>{"avatar"==this.page_name||this.page_moving||(e.setPosition(t.x,t.y),this.update_visible_page("free"))}}),t.setScale(1.2,1),this.add(t),t=new j(this.scene,{x:11.5*i,y:3.5*i,atlas:"new",frame_out:"plank_frame",callback:t=>{"frame"==this.page_name||this.page_moving||(e.setPosition(t.x,t.y),this.update_visible_page("coins"))}}),t.setScale(1.2,1),this.add(t),t=new j(this.scene,{x:18.5*i,y:3.5*i,atlas:"new",frame_out:"plank_frame",callback:t=>{"feet"==this.page_name||this.page_moving||(e.setPosition(t.x,t.y),this.update_visible_page("gems"))}}),t.setScale(1.2,1),this.add(t),t=new j(this.scene,{x:25*i,y:3.5*i,atlas:"new",frame_out:"plank_frame",callback:t=>{"flag"==this.page_name||this.page_moving||(e.setPosition(t.x,t.y),this.update_visible_page("promotion"))}}),t.setScale(1.2,1),this.add(t)}update_visible_page(e){const t={free:this.free_page,coins:this.coins_page,gems:this.gems_page,promotion:this.promotion_page};this.page_moving=!0,this.current_page?this.scene.tweens.add({targets:this.current_page,alpha:0,duration:150,onComplete:()=>{this.current_page.visible=!1,this.page_name=e,this.current_page=t[this.page_name],this.current_page.visible=!0,this.scene.tweens.add({targets:this.current_page,alpha:1,duration:150,onComplete:()=>{this.page_moving=!1}})}}):(this.page_name=e,this.current_page=t[this.page_name],this.current_page.visible=!0,this.scene.tweens.add({targets:this.current_page,alpha:1,duration:200,onComplete:()=>{this.page_moving=!1}}))}create_free_page(){let e=x.cell_width;this.free_page=new(a().GameObjects.Container)(this.scene),this.free_page.alpha=0,this.free_page.visible=!1,this.add(this.free_page);let t,i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),i.lineBetween(0,5*e,y.width,5*e),this.free_page.add(i),t=new(a().GameObjects.Text)(this.scene,5*e,3.5*e,"FREE",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.free_page.add(t),t=new(a().GameObjects.Text)(this.scene,11.5*e,3.5*e,"COINS",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.free_page.add(t),t=new(a().GameObjects.Text)(this.scene,18.5*e,3.5*e,"GEMS",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.free_page.add(t),t=new(a().GameObjects.Text)(this.scene,25*e,3.5*e,"PROMOTIONS",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.free_page.add(t)}handler_choose_ava(e){}create_coins_page(){let e=x.cell_width;this.coins_page=new(a().GameObjects.Container)(this.scene),this.coins_page.alpha=0,this.coins_page.visible=!1,this.add(this.coins_page);let t,i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),this.coins_page.add(i),t=new(a().GameObjects.Text)(this.scene,5*e,3.5*e,"FREE",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.coins_page.add(t),t=new(a().GameObjects.Text)(this.scene,11.5*e,3.5*e,"COINS",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.coins_page.add(t),t=new(a().GameObjects.Text)(this.scene,18.5*e,3.5*e,"GEMS",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.coins_page.add(t),t=new(a().GameObjects.Text)(this.scene,25*e,3.5*e,"PROMOTIONS",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.coins_page.add(t);let s=new(a().GameObjects.Container)(this.scene);this.coins_page.add(s);let n=0;x.shop.purchase_items.forEach((t=>{if("coins"===t.type){let i,o,l=new(a().GameObjects.Container)(this.scene,4*e+n*e*7,8.5*e),h=new(a().GameObjects.Graphics)(this.scene);h.lineStyle(6,467577,1),h.strokeRect(-3*e+3,-2.5*e+3,6*e-3,6*e-3),l.add(h),i=new(a().GameObjects.Image)(this.scene,1,-3*e,"new","plank"),i.setScale(6/11+.015,1),l.add(i),o=new(a().GameObjects.Text)(this.scene,1,-3*e,"COINS PACK",{fontFamily:"rubik",fontSize:28}),o.setOrigin(.5),l.add(o),i=new(a().GameObjects.Image)(this.scene,0,-.5*e,"shop",t.icon),i.height>3*e&&i.setScale(3*e/i.height),l.add(i),i=new(a().GameObjects.Image)(this.scene,1,2*e,"new","plank"),i.setScale(4/11,1),l.add(i),o=new(a().GameObjects.Text)(this.scene,1,2*e,String(t.items.money),{fontFamily:"rubik",fontSize:36}),o.setOrigin(.5),l.add(o),i=new(a().GameObjects.Image)(this.scene,0,4*e,"new","purple_button"),l.add(i),i.setInteractive(),i.on("pointerup",(()=>{})),o=new(a().GameObjects.Text)(this.scene,0,4*e,String(t.price),{fontFamily:"rubik",fontSize:36}),o.setOrigin(.5),l.add(o),s.add(l),n++}}))}create_gems_page(){let e=x.cell_width;this.gems_page=new(a().GameObjects.Container)(this.scene),this.gems_page.alpha=0,this.gems_page.visible=!1,this.add(this.gems_page);let t,i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),this.gems_page.add(i),t=new(a().GameObjects.Text)(this.scene,5*e,3.5*e,"FREE",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.gems_page.add(t),t=new(a().GameObjects.Text)(this.scene,11.5*e,3.5*e,"COINS",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.gems_page.add(t),t=new(a().GameObjects.Text)(this.scene,18.5*e,3.5*e,"GEMS",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.gems_page.add(t),t=new(a().GameObjects.Text)(this.scene,25*e,3.5*e,"PROMOTIONS",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.gems_page.add(t);let s=new(a().GameObjects.Container)(this.scene);this.gems_page.add(s);let n=0;x.shop.purchase_items.forEach((t=>{if("gems"===t.type){let i,o,l=new(a().GameObjects.Container)(this.scene,4*e+n*e*7,8.5*e),h=new(a().GameObjects.Graphics)(this.scene);h.lineStyle(6,467577,1),h.strokeRect(-3*e+3,-2.5*e+3,6*e-3,6*e-3),l.add(h),i=new(a().GameObjects.Image)(this.scene,1,-3*e,"new","plank"),i.setScale(6/11+.015,1),l.add(i),o=new(a().GameObjects.Text)(this.scene,1,-3*e,"COINS PACK",{fontFamily:"rubik",fontSize:28}),o.setOrigin(.5),l.add(o),i=new(a().GameObjects.Image)(this.scene,0,-.5*e,"shop",t.icon),i.height>3*e&&i.setScale(3*e/i.height),l.add(i),i=new(a().GameObjects.Image)(this.scene,1,2*e,"new","plank"),i.setScale(4/11,1),l.add(i),o=new(a().GameObjects.Text)(this.scene,1,2*e,String(t.items.gems),{fontFamily:"rubik",fontSize:36}),o.setOrigin(.5),l.add(o),i=new(a().GameObjects.Image)(this.scene,0,4*e,"new","purple_button"),l.add(i),i.setInteractive(),i.on("pointerup",(()=>{})),o=new(a().GameObjects.Text)(this.scene,0,4*e,String(t.price),{fontFamily:"rubik",fontSize:36}),o.setOrigin(.5),l.add(o),s.add(l),n++}}))}create_promotion_page(){let e=x.cell_width;this.promotion_page=new(a().GameObjects.Container)(this.scene),this.promotion_page.alpha=0,this.promotion_page.visible=!1,this.add(this.promotion_page);let t,i=new(a().GameObjects.Graphics)(this.scene);i.lineStyle(7,335737,1),i.lineBetween(0,5*e,y.width,5*e),this.promotion_page.add(i),t=new(a().GameObjects.Text)(this.scene,5*e,3.5*e,"FREE",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.promotion_page.add(t),t=new(a().GameObjects.Text)(this.scene,11.5*e,3.5*e,"COINS",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.promotion_page.add(t),t=new(a().GameObjects.Text)(this.scene,18.5*e,3.5*e,"GEMS",{fontFamily:"rubik",fontSize:36,color:"#051F79"}),t.setOrigin(.5),this.promotion_page.add(t),t=new(a().GameObjects.Text)(this.scene,25*e,3.5*e,"PROMOTIONS",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.promotion_page.add(t)}show(){}handler_close(){}}class E extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.create_folders_buttons(),this.create_flag_page()}create_folders_buttons(){let e,t,i=x.cell_width;e=new(a().GameObjects.Image)(this.scene,y.width/2,3.5*i,"new","plank"),e.setScale(2.8,1),this.add(e),t=new(a().GameObjects.Text)(this.scene,y.width/2,3.5*i,"ACHIVMENTS",{fontFamily:"rubik",fontSize:36,color:"#FFFFFF"}),t.setOrigin(.5),this.add(t)}create_flag_page(){let e=x.cell_width;this.flag_page=new(a().GameObjects.Container)(this.scene),this.add(this.flag_page);let t=new(a().GameObjects.Graphics)(this.scene);t.lineStyle(7,335737,1),t.lineBetween(0,5*e,y.width,5*e),t.lineBetween(26.5*e,5.5*e,26.5*e,15.5*e),this.flag_page.add(t);let i=new S(this.scene,{width:24*e,height:11*e});this.flag_page.add(i),i.setXY(y.width/2,y.height/2+2.5*e);let s,o=new(a().GameObjects.Image)(this.scene,26.5*e,5.5*e,"new","scroller");this.flag_page.add(o),i.on("scrollProgress",(t=>{o.y=5.5*e+10*(1-t)*e}));for(let t=0;t<16;t++){let o=t%4*e*5.5+2*e,l=Math.floor(t/4)*e*9+4*e;s=new(a().GameObjects.Rectangle)(this.scene,o,l,5*e,8*e,0,0),s.setStrokeStyle(5,335737,1),i.add_child(s),s=new(a().GameObjects.Image)(this.scene,o,l-3.5*e,"new","plank"),s.setScale(.46,1),i.add_child(s),s=new(a().GameObjects.Image)(this.scene,o,l-.5*e,"medal"),i.add_child(s),s=new n(this.scene,{atlas:"new",frame_bg:"plank",frame_bar:"oil_progress"}),s.bg.setScale(.73,1),s.update_progress(Math.random()),s.setPosition(o,l+3*e),s.setScale(.55,1),i.add_child(s),s=new(a().GameObjects.Text)(this.scene,o,l-3.5*e,"ACHIVMENT NAME",{fontFamily:"rubik",fontSize:28,color:"#FFFFFF"}),s.setOrigin(.5),i.add_child(s),s=new(a().GameObjects.Text)(this.scene,o,l+1.7*e,"Sink single-deck ships\nwithout failures",{fontFamily:"rubik",fontSize:24,color:"#051F79",align:"center"}),s.setOrigin(.5),i.add_child(s)}}show(){}handler_close(){}}class R extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.create_main_prize(),this.create_rating_slider()}create_main_prize(){let e=x.cell_width+2,t=new(a().GameObjects.Rectangle)(this.scene,261,y.height/2+100,5*e,9*e);t.setStrokeStyle(5,467577,1),this.add(t);let i=new(a().GameObjects.Image)(this.scene,261,y.height/2-50,"game_play","chest_closed");i.setScale(1.5),this.add(i);let s=new(a().GameObjects.Text)(this.scene,261,y.height/2-250,"ADMIRAL REWARD",{fontFamily:"rubik",fontSize:32,color:"#051F79"});s.setOrigin(.5),this.add(s),s=new(a().GameObjects.Text)(this.scene,261,y.height/2+118,"Log in every day and\nwin a special prize!",{fontFamily:"rubik",fontSize:28,color:"#051F79",align:"center"}),s.setOrigin(.5),this.add(s),this.create_day_bar()}create_day_bar(){let e=x.cell_width;this.day_bar=new n(this.scene,{atlas:"new",frame_bg:"plank",frame_bar:"oil_progress"}),this.day_bar.bg.setScale(.73,1),this.day_bar.update_progress((x.user_data.daily_reward.amount+1)/x.daily_rewards.length),this.day_bar.setPosition(261,y.height/2+100+2.7*e),this.day_bar.setScale(.6,.9),this.add(this.day_bar),this.day_bar_txt=new(a().GameObjects.Text)(this.scene,261,y.height/2+100+1.7*e,`DAY ${x.user_data.daily_reward.amount+1}/${x.daily_rewards.length}`,{fontFamily:"rubik",fontSize:36,color:"#051F79"}),this.day_bar_txt.setOrigin(.5,.5),this.add(this.day_bar_txt)}create_rating_slider(){let e=x.cell_width,t=new S(this.scene,{width:18*e,height:10*e});this.add(t),t.setXY(16*e,10*e);let i,s=new(a().GameObjects.Image)(this.scene,y.width-2.1*e,5*e,"new","scroller");this.add(s),t.on("scrollProgress",(t=>{s.y=5.5*e+10*(1-t)*e}));let o,l=8.6*e;i=new(a().GameObjects.Image)(this.scene,16.5*e,3.5*e,"new","plank"),i.setScale(1.59,1),this.add(i);for(let s=0;s<10;s++)o=1*e+2.3*s*e,i=new(a().GameObjects.Image)(this.scene,1.3*e,o,"temp_task_reward"),t.add_child(i),i=new(a().GameObjects.Rectangle)(this.scene,l+.3*e,o,17*e,2*e,335737,0),i.setStrokeStyle(5,335737,1),t.add_child(i),i=new(a().GameObjects.Text)(this.scene,3*e,o-20,"TASK NAME",{fontFamily:"rubik",fontSize:28,color:"#051F79"}),i.setOrigin(0,.5),t.add_child(i),i=new n(this.scene,{atlas:"new",frame_bg:"plank",frame_bar:"oil_progress"}),i.bg.setScale(.73,1),i.update_progress(Math.random()),i.setPosition(l-.7*e,o+30),i.setScale(1.3,.7),t.add_child(i),i=new(a().GameObjects.Image)(this.scene,l+440,o,"new","blue_button"),i.setScale(.8),t.add_child(i)}show(){}handler_close(){}}class A extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.cell_width=x.cell_width,this.create_back(),this.create_interface(),this.create_scenes()}create_back(){this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(0,0,y.width,y.height),this.add(this.bg);let e=Math.ceil(y.height/this.cell_width),t=Math.ceil(y.width/this.cell_width);this.bg.lineStyle(2,6386084,.7);for(let t=0;t<=e;t++)this.bg.lineBetween(0,t*this.cell_width,y.width,t*this.cell_width);for(let e=0;e<=t;e++)this.bg.lineBetween(e*this.cell_width,0,e*this.cell_width,y.height);this.bg.lineStyle(7,13582392,.9),this.bg.lineBetween(0,3*this.cell_width,y.width,3*this.cell_width)}create_scenes(){this.profile=new F(this.scene),this.personalization=new I(this.scene),this.settings=new T(this.scene),this.leaderboard=new z(this.scene),this.shop=new C(this.scene),this.achivments=new E(this.scene),this.tasks=new R(this.scene),this.add([this.profile,this.personalization,this.settings,this.leaderboard,this.shop,this.achivments,this.tasks]),this.update_scenes("profile")}update_scenes(e){const t={profile:this.profile,personalization:this.personalization,settings:this.settings,leaderboard:this.leaderboard,shop:this.shop,achivments:this.achivments,tasks:this.tasks};let i=!1;Object.keys(t).forEach((s=>{i=s===e,t[s]&&(t[s].visible=i),i?t[s].show():t[s].handler_close()}))}create_interface(){let e;this.home_button=new j(this.scene,{x:6.5*this.cell_width,y:1.5*this.cell_width,atlas:"new",frame_out:"plank",callback:()=>{u.update_scenes("game_menu")}}),this.home_button.out_img.setScale(.65,1),e=new(a().GameObjects.Image)(this.scene,-4*this.cell_width,0,"game_play","back_icon"),e.setInteractive(),e.on("pointerup",(()=>{u.update_scenes("game_menu")})),this.home_button.add(e);let t=new(a().GameObjects.Text)(this.scene,0,0,"MAIN MENU",{fontFamily:"rubik",fontSize:"36"});t.setOrigin(.5),this.home_button.add(t),this.add(this.home_button)}}class M extends a().GameObjects.Container{constructor(e,t){super(e),this.init(t)}init(e){let{atlas:t,broke_frame:i,live_frame:s}=e;this.x=e.pos.x,this.y=e.pos.y,e.scale&&(this.scale=e.scale),this.broke_image=new(a().GameObjects.Image)(this.scene,0,0,t||i,t?i:void 0),this.live_image=new(a().GameObjects.Image)(this.scene,0,0,t||s,t?s:void 0),this.add([this.broke_image,this.live_image]),this.state_live=!1,this.update_living()}update_living(){this.broke_image.visible=!this.state_live,this.live_image.visible=this.state_live}}class B extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.zoom=0,this.create_roads(),this.init_interactive()}init_interactive(){this.interactive_shape=new(a().GameObjects.Rectangle)(this.scene,0,0,y.width,y.height),this.setInteractive(this.interactive_shape,a().Geom.Rectangle.Contains),this.scene.input.addPointer(1),this.scene.input.on("wheel",((e,t,i,s,a,n)=>{this.active_map&&this.update_zoom(e,-s)})),this.bg.setInteractive({draggable:!0}),this.bg.on("drag",((e,t,i)=>{this.active_map&&this.update_drag(t,i)}))}update(){if(this.scene.input.pointer1&&this.scene.input.pointer1.isDown&&this.scene.input.pointer2&&this.scene.input.pointer2.isDown){this.prev_pos1||(this.prev_pos1={x:this.scene.input.pointer1.x,y:this.scene.input.pointer1.y}),this.prev_pos2||(this.prev_pos2={x:this.scene.input.pointer2.x,y:this.scene.input.pointer2.y});let e=this.scene.input.pointer1,t=this.scene.input.pointer2;this.update_zoom({x:(e.x+t.x)/2,y:(e.y+t.y)/2},3*(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))-Math.sqrt(Math.pow(this.prev_pos2.x-this.prev_pos1.x,2)+Math.pow(this.prev_pos2.y-this.prev_pos1.y,2))))}}update_drag(e,t){e>y.width/2&&(e=y.width/2),e<y.width/2&&(e=y.width/2),t>y.height/2&&(t=y.height/2),t<y.height/2&&(t=y.height/2),this.bg.setPosition(e,t)}update_zoom(e,t){let i=this.zoom+t/10;i>=10&&i<=100&&(this.zoom=i,this.scene.tweens.add({targets:this,x:-e.x*this.zoom/100,y:-e.y*this.zoom/100,scale:this.zoom/100+1,duration:100}))}create_roads(){this.bg=new(a().GameObjects.Image)(this.scene,y.width/2,y.height/2,"main_bg"),this.bg.setScale(y.height/this.bg.height),this.add(this.bg)}create_items(){let e,t=this.scene.cache.json.get("map_items");console.log(t),t.forEach((t=>{e=new M(this.scene,t),this.add(e)}))}}class P extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.bg=new(a().GameObjects.Image)(this.scene,y.width/2,y.height/2,"page_bg"),this.bg.setScale(y.height/this.bg.height),this.add(this.bg),this.create_game_map(),this.darker=new(a().GameObjects.Image)(this.scene,0,0,"darkner"),this.darker.setOrigin(0),this.darker.setScale(y.width/this.darker.width,y.height/this.darker.height),this.add(this.darker),this.create_interface()}create_game_map(){this.game_map=new B(this.scene),this.add(this.game_map)}create_interface(){this.profile_container=new(a().GameObjects.Container)(this.scene,100,120),this.add(this.profile_container),this.ava_frame=new(a().GameObjects.Image)(this.scene,20,20,"ava_frame"),this.ava=new(a().GameObjects.Image)(this.scene,this.ava_frame.x,this.ava_frame.y,"new","profile_ava"),this.profile_bg=new(a().GameObjects.Image)(this.scene,this.ava.x+this.ava.width/2,this.ava.y-this.ava.height/2,"game_menu","medium_back"),this.profile_bg.setInteractive(),this.profile_bg.on("pointerup",(()=>{u.big_windows.update_scenes("profile"),u.update_scenes("big_windows")})),this.profile_bg.setOrigin(0),this.profile_container.add([this.ava_frame,this.profile_bg,this.ava]),this.custom_button=new j(this.scene,{x:this.profile_bg.x+this.profile_container.x,y:0,atlas:"game_menu",frame_out:"little_back",callback:()=>{u.big_windows.update_scenes("personalization"),u.update_scenes("big_windows")}}),this.custom_button.scale=1.1,this.custom_button.x+=this.profile_bg.width+this.custom_button.out_img.width/2+15,this.custom_button.y+=this.profile_bg.height/2-10,this.add(this.custom_button),this.settings_button=new j(this.scene,{x:y.width-20,y:this.profile_bg.y+this.profile_container.y,atlas:"game_menu",frame_out:"micro_back",callback:()=>{u.windows_manager.show_window("options")}}),this.settings_button.setOrigin(1,0),this.add(this.settings_button),this.play_button=new j(this.scene,{x:y.width-20,y:y.height-20,atlas:"game_menu",frame_out:"big_back",callback:()=>{x.game_play.with_bot?u.windows_manager.show_window("arena_slider"):(u.game_play.update_scenes("prepare_field"),u.update_scenes("game_play"))}}),this.play_button.setOrigin(1),this.add(this.play_button);let e=new(a().GameObjects.Image)(this.scene,-100,0,"game_menu","icon_play");this.play_button.add(e);let t=new(a().GameObjects.Text)(this.scene,50,0,"BATTLE",{fontFamily:"rubik",fontSize:48});t.setOrigin(.5),this.play_button.add(t),this.mode_button_container=new(a().GameObjects.Container)(this.scene,this.play_button.x-(this.play_button.out_img.width/2+20),this.play_button.y+this.play_button.out_img.height/2),this.add(this.mode_button_container);let i=new(a().GameObjects.Text)(this.scene,-150,-120,"BOT GAME",{fontFamily:"rubik",fontSize:28,color:"#3C2415"});i.setOrigin(.5),this.mode_bg=new(a().GameObjects.Image)(this.scene,0,0,"game_menu","medium_back"),this.mode_bg.setOrigin(1),this.mode_bg.setInteractive(),this.mode_bg.on("pointerup",(()=>{"icon_bot"===this.mode_img.frame.name?(x.game_play.with_bot=!1,this.mode_img.setFrame("icon_friend"),this.mode_img.x=-240,i.text="FRIENDS GAME",i.setFontSize(22)):(x.game_play.with_bot=!0,this.mode_img.setFrame("icon_bot"),this.mode_img.x=-250,i.text="BOT GAME",i.setFontSize(28)),this.mode_img.setOrigin(1)})),this.mode_img=new(a().GameObjects.Image)(this.scene,-250,-50,"game_menu","icon_bot"),this.mode_img.setOrigin(1),this.mode_button_container.add([this.mode_bg,this.mode_img]);let s=new(a().GameObjects.Rectangle)(this.scene,-130,-70,180,40,3941397,1);this.mode_button_container.add(s),this.mode_button_container.add(i);let n=new(a().GameObjects.Text)(this.scene,-120,-70,"REWARD X2",{fontFamily:"rubik",fontSize:24,color:"#FFFFFF"});n.setOrigin(.5),this.mode_button_container.add(n),e=new(a().GameObjects.Image)(this.scene,-220,-70,"game_menu","coin"),e.setScale(.65),this.mode_button_container.add(e),this.create_buttons()}create_banner(){let e=new(a().GameObjects.Image)(this.scene,20,y.height-20,"game_menu","big_back");e.setOrigin(0,1),this.add(e);let t=new(a().GameObjects.Text)(this.scene,e.x+e.width/2,e.y-e.height/2,"BANNER",{fontFamily:"rubik",fontSize:48,color:"#051F79"});t.setOrigin(.5),this.add(t)}create_buttons(){let e,t,i,s=[{x:150,y:y.height/2},{x:150,y:y.height/2+200},{x:y.width-150,y:y.height/2-200},{x:y.width-150,y:y.height/2},{x:y.width-150,y:y.height/2+200}];e=new j(this.scene,{x:s[0].x,y:s[0].y,atlas:"game_menu",frame_out:"basic_button",callback:()=>{u.big_windows.update_scenes("leaderboard"),u.update_scenes("big_windows")}}),t=new(a().GameObjects.Image)(this.scene,0,-15,"game_menu","icon_leaderboard"),i=new(a().GameObjects.Text)(this.scene,0,35,"TOP",{fontFamily:"rubik",fontSize:24,color:"#3C2415"}),i.setOrigin(.5),e.add([t,i]),this.add(e),e=new j(this.scene,{x:s[1].x,y:s[1].y,atlas:"game_menu",frame_out:"basic_button",callback:()=>{u.windows_manager.show_window("daily_reward")}}),t=new(a().GameObjects.Image)(this.scene,0,-15,"game_menu","icon_daily"),i=new(a().GameObjects.Text)(this.scene,0,35,"DAILY",{fontFamily:"rubik",fontSize:24,color:"#3C2415"}),i.setOrigin(.5),e.add([t,i]),this.add(e),e=new j(this.scene,{x:s[2].x,y:s[2].y,atlas:"game_menu",frame_out:"basic_button",callback:()=>{u.big_windows.update_scenes("tasks"),u.update_scenes("big_windows")}}),this.add(e),t=new(a().GameObjects.Image)(this.scene,0,-15,"game_menu","icon_tasks"),i=new(a().GameObjects.Text)(this.scene,0,35,"MISSION",{fontFamily:"rubik",fontSize:18,color:"#3C2415"}),i.setOrigin(.5),e.add([t,i]),e=new j(this.scene,{x:s[3].x,y:s[3].y,atlas:"game_menu",frame_out:"basic_button",callback:()=>{u.big_windows.update_scenes("shop"),u.update_scenes("big_windows")}}),t=new(a().GameObjects.Image)(this.scene,0,-15,"game_menu","icon_store"),i=new(a().GameObjects.Text)(this.scene,0,35,"STORE",{fontFamily:"rubik",fontSize:24,color:"#3C2415"}),i.setOrigin(.5),e.add([t,i]),this.add(e),e=new j(this.scene,{x:s[4].x,y:s[4].y,atlas:"game_menu",frame_out:"basic_button",callback:()=>{this.game_map.active_map=!this.game_map.active_map}}),t=new(a().GameObjects.Image)(this.scene,0,-15,"game_menu","icon_city"),i=new(a().GameObjects.Text)(this.scene,0,35,"CITY",{fontFamily:"rubik",fontSize:24,color:"#3C2415"}),i.setOrigin(.5),e.add([t,i]),this.add(e)}}class D extends a().GameObjects.Container{constructor(e,t){super(e),this.init(t)}on_turn(){this.turn=!0}off_turn(){this.turn=!1,this.points_x.forEach((e=>{e.visible=!1})),this.points_y.forEach((e=>{e.visible=!1}))}all_cells_was_hited(){return this.all_cells_count===this.hited_cells_count}all_ships_was_hited(){return this.all_ships_count===this.hited_ships_count}get_cell(e,t,i){let s=null;return this.cells_imgs.forEach((a=>{e===a.x&&t===a.y&&(s=a,this.hited_cells.some((i=>i.x===e&&i.y===t))||i||this.hited_cells_count++)})),i||this.hited_cells.push({x:e,y:t}),s}check_ship(e,t){let i;if(this.ships_arr.forEach((s=>{s.cells.some((i=>i.x===e&&i.y===t))&&(i=s)})),i){let e=!0;if(i.cells.forEach((t=>{this.hited_cells.some((e=>e.x===t.x&&e.y===t.y))||(e=!1)})),i.visible=e,e){this.hited_ships_count++;let e=i.cells[0].x-1,t=i.cells[i.cells.length-1].x+1,s=i.cells[0].y-1,a=i.cells[i.cells.length-1].y+1;for(let i=s;i<=a;i++)for(let s=e;s<=t;s++){let e=this.get_cell(s,i);e&&(e.obj.visible=!0)}}}}hit(e,t,i){let s=!1,n=null;if(this.hited_cells.some((i=>i.x===e&&i.y===t)))i||this.hit_ignore(),this.points_x.forEach((e=>{e.visible=!1})),this.points_y.forEach((e=>{e.visible=!1}));else{i||this.hit_start(),n=this.get_cell(e,t),n&&n&&(s=n.succ),s||(this.points_x.forEach((e=>{e.visible=!1})),this.points_y.forEach((e=>{e.visible=!1})));let o=this.cell_width/2+e*this.cell_width,l=this.cell_width/2+t*this.cell_width;if(i){let i=new(a().GameObjects.Sprite)(this.scene,o,l,s?"explo_1":"splash_1");s||(i.scale=.7),i.on("animationcomplete",(()=>{this.check_ship(e,t),n&&(n.obj.visible=!0),i.destroy})),this.add(i),i.play(s?"explo":"splash")}else{let i=new(a().GameObjects.Image)(this.scene,o,l,"projectile");i.setOrigin(1),this.add(i),this.scene.tweens.add({targets:i,scale:0,duration:300,onComplete:()=>{let i=new(a().GameObjects.Sprite)(this.scene,o,l,s?"explo_1":"splash_1");s||(i.scale=.7),i.on("animationcomplete",(()=>{this.hit_callback(s),this.check_ship(e,t),n&&(n.obj.visible=!0),i.destroy})),this.add(i),i.play(s?"explo":"splash")}})}}return s}fill_cells(e,t){this.cells_imgs=[];let i,s="cell_false";this.field.forEach(((e,n)=>{e.forEach(((e,o)=>{s=1===e?"cell_true":"cell_false",i=new(a().GameObjects.Image)(this.scene,t/2+t*o,t/2+t*n,s),i.setScale(t/i.width),i.visible=!1,this.all_cells_count++,this.cells_container.add(i),this.cells_imgs.push({obj:i,x:o,y:n,succ:1===e})}))}))}fill_ships(e,t){let i,s,n=[];this.ships.forEach(((e,o)=>{s=e.y_l>e.x_l,i=new(a().GameObjects.Image)(this.scene,t/2+e.x*t,t/2+e.y*t,"ship_"+(s?e.y_l+1:e.x_l+1)+"_death"),i.scale=t*(s?e.y_l+1:e.x_l+1)/i.width,i.setOrigin(t/2/(i.width*i.scale),.5),i.setAngle(s?90:0),n=[];for(let t=e.y;t<=e.y+e.y_l;t++)for(let i=e.x;i<=e.x+e.x_l;i++)n.push({x:i,y:t});this.all_ships_count++,i.cells=n,i.visible=!1,this.ships_arr.push(i),this.ships_container.add(i)}))}create_pointer(e,t){this.setInteractive(new(a().Geom.Rectangle)(0,0,10*t,10*t),a().Geom.Rectangle.Contains),this.points_x=[new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell")],this.points_x.forEach(((e,i)=>{e.scale=t/e.width,e.y=i*t+t/2,e.alpha=.5,e.visible=!1})),this.points_y=[new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell"),new(a().GameObjects.Image)(this.scene,0,0,"point_cell")],this.points_y.forEach(((e,i)=>{e.scale=t/e.width,e.x=i*t+t/2,e.alpha=.5,e.visible=!1})),this.add(this.points_x),this.add(this.points_y);let i={x:0,y:0},s={x:0,y:0};this.on("pointermove",(e=>{i.x=t/2+Math.floor((e.x-this.x)/t)*t,i.y=t/2+Math.floor((e.y-this.y)/t)*t,this.points_x.forEach((e=>{e.x=i.x})),this.points_y.forEach((e=>{e.y=i.y}))})),this.on("pointerover",(e=>{this.over_cell=!0,this.turn&&(this.points_x.forEach((t=>{t.visible=e.isDown})),this.points_y.forEach((t=>{t.visible=e.isDown})))})),this.on("pointerout",(e=>{this.over_cell=!1,this.turn&&(this.points_x.forEach((e=>{e.visible=!1})),this.points_y.forEach((e=>{e.visible=!1})))})),this.on("pointerdown",(e=>{this.turn&&(this.points_x.forEach((e=>{e.visible=this.over_cell})),this.points_y.forEach((e=>{e.visible=this.over_cell})))})),this.on("pointerup",(e=>{this.turn&&(this.points_x.forEach((e=>{e.visible=!1})),this.points_y.forEach((e=>{e.visible=!1})),s.x=Math.floor((e.x-this.x)/t),s.y=Math.floor((e.y-this.y)/t),this.hit(s.x,s.y))}))}init(e){this.x=e.x,this.y=e.y;let t=1*x.cell_width+2;this.cell_width=t,this.field=e.field,this.ships=e.ships,this.hit_callback=e.hit_callback,this.hit_start=e.hit_start,this.hit_ignore=e.hit_ignore,this.ships_arr=[],this.all_cells_count=0,this.hited_cells_count=0,this.all_ships_count=0,this.hited_ships_count=0,this.hited_cells=[],this.ships_container=new(a().GameObjects.Container)(this.scene),this.add(this.ships_container),this.cells_container=new(a().GameObjects.Container)(this.scene),this.add(this.cells_container),this.fill_ships(1,t),this.fill_cells(1,t),this.create_pointer(1,t)}}class L{constructor(e){this.field=e,this.old_points=[],this.ship_points=[],this.ship_length=0}get_random_point(){return{x:Phaser.Math.Between(0,9),y:Phaser.Math.Between(0,9)}}get_ship(e,t){let i=[];const s=(e,t)=>{var a,n,o,l,h,r,c,d;i.push({x:e,y:t}),1!==(null===(n=null===(a=this.field)||void 0===a?void 0:a[t-1])||void 0===n?void 0:n[e])||i.some((i=>i.x===e&&i.y===t-1))||s(e,t-1),1!==(null===(l=null===(o=this.field)||void 0===o?void 0:o[t])||void 0===l?void 0:l[e-1])||i.some((i=>i.x===e-1&&i.y===t))||s(e-1,t),1!==(null===(r=null===(h=this.field)||void 0===h?void 0:h[t+1])||void 0===r?void 0:r[e])||i.some((i=>i.x===e&&i.y===t+1))||s(e,t+1),1!==(null===(d=null===(c=this.field)||void 0===c?void 0:c[t])||void 0===d?void 0:d[e+1])||i.some((i=>i.x===e+1&&i.y===t))||s(e+1,t)};return s(e,t),i.length}set_death_ship(){let e=9,t=0,i=9,s=0;this.ship_points.forEach((a=>{e>a.x&&(e=a.x),t<a.x&&(t=a.x),i>a.y&&(i=a.y),s<a.y&&(s=a.y)}));for(let a=i-1;a<=s+1;a++)for(let i=e-1;i<=t+1;i++)this.old_points.push({x:i,y:a})}turn(){var e,t,i,s,a,n,o,l;let h;if(0===this.ship_points.length)return h=this.get_random_point(),this.old_points.some((e=>e.x===h.x&&e.y===h.y))?this.turn():(this.old_points.push(h),1===this.field[h.y][h.x]&&(this.ship_length=this.get_ship(h.x,h.y),this.ship_points.push(Object.assign({},h)),this.ship_length<=this.ship_points.length&&(this.ship_length=0,this.ship_points=[])),h);if(1===this.ship_points.length)return h=Object.assign({},this.ship_points[0]),Math.random()>.5?h.y+=Math.random()>.5?1:-1:h.x+=Math.random()>.5?1:-1,0!==(null===(t=null===(e=this.field)||void 0===e?void 0:e[h.y])||void 0===t?void 0:t[h.x])&&1!==(null===(s=null===(i=this.field)||void 0===i?void 0:i[h.y])||void 0===s?void 0:s[h.x])||this.old_points.some((e=>e.x===h.x&&e.y===h.y))?this.turn():(this.old_points.push(h),1===this.field[h.y][h.x]&&(this.ship_points.push(Object.assign({},h)),this.ship_length<=this.ship_points.length&&(this.set_death_ship(),this.ship_length=0,this.ship_points=[])),h);if(this.ship_points.length>1){let e=9,t=0,i=9,s=0;return this.ship_points.forEach((a=>{e>a.x&&(e=a.x),t<a.x&&(t=a.x),i>a.y&&(i=a.y),s<a.y&&(s=a.y)})),h=e===t?{x:e,y:Math.random()>.5?i-1:s+1}:{x:Math.random()>.5?e-1:t+1,y:i},0!==(null===(n=null===(a=this.field)||void 0===a?void 0:a[h.y])||void 0===n?void 0:n[h.x])&&1!==(null===(l=null===(o=this.field)||void 0===o?void 0:o[h.y])||void 0===l?void 0:l[h.x])||this.old_points.some((e=>e.x===h.x&&e.y===h.y))?this.turn():(this.old_points.push(h),1===this.field[h.y][h.x]&&(this.ship_points.push(Object.assign({},h)),this.ship_length<=this.ship_points.length&&(this.set_death_ship(),this.ship_length=0,this.ship_points=[])),h)}}}class N extends a().GameObjects.Container{constructor(e,t){super(e),this.init(t)}create_back(){this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(0,0,y.width,y.height);let e=Math.ceil(y.height/this.cell_width),t=Math.ceil(y.width/this.cell_width);this.bg.lineStyle(2,6386084,.7);for(let t=0;t<=e;t++)this.bg.lineBetween(0,t*this.cell_width,y.width,t*this.cell_width);for(let e=0;e<=t;e++)this.bg.lineBetween(e*this.cell_width,0,e*this.cell_width,y.height);this.bg.lineStyle(7,13582392,.9),this.bg.lineBetween(0,3*this.cell_width,y.width,3*this.cell_width),this.add(this.bg)}check_endgame(){return this.first_player_field.all_cells_was_hited()||this.first_player_field.all_ships_was_hited()?(x.game_play.fields=[],u.windows_manager.show_window("result_battle",{win:!1}),!1):!this.second_player_field.all_cells_was_hited()&&!this.second_player_field.all_ships_was_hited()||(x.game_play.fields=[],u.windows_manager.show_window("result_battle",{win:!0}),!1)}anim_mine(e,t){let i=x.cell_width+2,s=new(a().GameObjects.Image)(this.scene,(e+.5)*i+this.first_player_field.x,(t+.5)*i+this.first_player_field.y,"mine");s.setScale(.8),s.alpha=0,this.anim_container.add(s),this.scene.tweens.add({targets:s,alpha:1,scale:1,duration:300,onComplete:()=>{let e=new(a().GameObjects.Sprite)(this.scene,s.x,s.y,"explo_3");e.on("animationcomplete",(()=>{e.destroy()})),e.alpha=1,this.anim_container.add(e),e.play("shot"),s.destroy()}})}bot_turn(){let e=this.bot.turn();setTimeout((()=>{this.first_player_field.hit(e.x,e.y),x.game_play.fields[0].mine.some((t=>t.x===e.x&&t.y===e.y))&&(this.anim_mine(e.x,e.y),this.second_player_field.hit(e.x,e.y,!0))}),300)}show(e){let t=1*x.cell_width+2;if(this.first_player_field=new D(this.scene,{field:x.game_play.fields[0].field,ships:x.game_play.fields[0].ships,x:2*t,y:5*t,hit_start:()=>{this.first_player_field.off_turn(),this.stop_timer()},hit_ignore:()=>{x.game_play.with_bot?this.bot_turn():this.first_player_field.on_turn()},hit_callback:e=>{e?this.flip_arrow(!0,(()=>{this.check_endgame(),x.game_play.with_bot?this.bot_turn():this.first_player_field.on_turn()})):this.flip_arrow(!1,(()=>{this.check_endgame()&&this.second_player_field.on_turn()}))}}),this.first_player_field.off_turn(),this.add(this.first_player_field),this.second_player_field=new D(this.scene,{field:x.game_play.fields[1].field,ships:x.game_play.fields[1].ships,x:16*t,y:5*t,hit_start:()=>{this.second_player_field.off_turn(),this.stop_timer()},hit_ignore:()=>{this.second_player_field.on_turn()},hit_callback:e=>{e?this.flip_arrow(!1,(()=>{this.check_endgame(),this.second_player_field.on_turn()})):this.flip_arrow(!0,(()=>{x.game_play.with_bot?this.bot_turn():this.check_endgame()&&this.first_player_field.on_turn()}))}}),this.second_player_field.on_turn(),this.flip_arrow(!1,(()=>{})),this.add(this.second_player_field),x.game_play.with_bot){const e=x.game_play.fields[0];this.bot=new L(e.field)}x.game_play.with_bot&&x.game_play.advanced&&this.create_skill_flat(),this.arsenal_button.visible=x.game_play.with_bot&&x.game_play.advanced}create_skill_flat(){let e=this.scene.plugins.get("rexshakepositionplugin");this.shake=e.add(this,{duration:4e3,mode:"effect"}),this.skill_flat_active=!0,this.skill_name="torpedo";let t=x.cell_width+2;this.skill_flat_container=new(a().GameObjects.Container)(this.scene,this.second_player_field.x+5*t,this.second_player_field.y+5*t),this.add(this.skill_flat_container),this.skill_flat_container.visible=!1;let i=new(a().GameObjects.Rectangle)(this.scene,0,0,10*t,10*t,16777215);i.alpha=.3,i.visible=!0,this.skill_flat_container.add(i),i.setInteractive();let s,n=!1;i.on("pointerdown",(()=>{this.skill_flat_active&&(n=!0)})).on("pointerup",(e=>{if(this.skill_flat_active){n=!1;let i=Math.floor((e.position.x-this.skill_flat_container.x+5*t)/t),s=Math.floor((e.position.y-this.skill_flat_container.y+5*t)/t);"bomber"===this.skill_name?(i<1&&(i=1),s<1&&(s=1),i>8&&(i=8),s>8&&(s=8),this.anim_bomber(i,s),this.bomber_mig.visible=!1):"atom"===this.skill_name?(i<1&&(i=1),s<1&&(s=1),i>6&&(i=6),s>6&&(s=6),this.anim_atom(i-1,s-1),this.atom_mig.visible=!1):"fighter"===this.skill_name?(s<1&&(s=1),i>7&&(i=7),i<1&&(i=1),this.anim_fighter(i,s),this.fighter_mig.visible=!1):"torpedo"===this.skill_name?(this.anim_torpedo(s),this.torpedo_mig.visible=!1):"radar"===this.skill_name?(i<1&&(i=1),s<1&&(s=1),i>8&&(i=8),s>8&&(s=8),this.anim_radar(i,s),this.radar_mig.visible=!1):"submarine"===this.skill_name&&(i<1&&(i=1),i>8&&(i=8),this.anim_submarine(i,s),this.submarine_mig.visible=!1),this.skill_flat_active=!1,this.skill_flat_container.visible=!1}})).on("pointerout",(()=>{this.skill_flat_active&&(n=!1)})).on("pointermove",(e=>{if(n&&this.skill_flat_active){let i=Math.floor((e.position.x-this.skill_flat_container.x+5*t)/t),s=Math.floor((e.position.y-this.skill_flat_container.y+5*t)/t);"bomber"===this.skill_name?(i<1&&(i=1),s<1&&(s=1),i>8&&(i=8),s>8&&(s=8),this.bomber_mig.setPosition(.5*t+t*i-5*t,.5*t+t*s-5*t)):"atom"===this.skill_name?(i<2&&(i=2),s<2&&(s=2),i>7&&(i=7),s>7&&(s=7),this.atom_mig.setPosition(.5*-t+t*i-5*t,.5*-t+t*s-5*t)):"radar"===this.skill_name?(i<1&&(i=1),s<1&&(s=1),i>8&&(i=8),s>8&&(s=8),this.radar_mig.setPosition(.5*t+t*i-5*t,.5*t+t*s-5*t)):"submarine"===this.skill_name?(i<1&&(i=1),i>8&&(i=8),this.submarine_mig.setPosition(.5*t+t*i-5*t,.5*t+t*s-5*t)):"fighter"===this.skill_name?(s<1&&(s=1),i>7&&(i=7),i<1&&(i=1),this.fighter_mig.setPosition(1.5*t+t*i-5*t,.5*t+t*s-5*t)):"torpedo"===this.skill_name&&(this.torpedo_mig.y=s*t+.5*t-4*t)}})),this.bomber_mig=new(a().GameObjects.Container)(this.scene,1.5*t-5*t,1.5*t-5*t),s=new(a().GameObjects.Image)(this.scene,1.5*t-t,1.5*t-t,"main_mig"),s.setScale(.8),this.bomber_mig.add(s),this.bomber_mig.visible=!1,this.skill_flat_container.add(this.bomber_mig),this.atom_mig=new(a().GameObjects.Container)(this.scene,1.5*t-5*t,1.5*t-5*t),s=new(a().GameObjects.Image)(this.scene,2*t-t,2*t-t,"main_mig"),this.atom_mig.add(s),s=new(a().GameObjects.Image)(this.scene,2*t-t,2*t-t,"atom_mig"),this.atom_mig.add(s),this.atom_mig.visible=!1,this.skill_flat_container.add(this.atom_mig),this.radar_mig=new(a().GameObjects.Container)(this.scene,1.5*t-5*t,1.5*t-5*t),s=new(a().GameObjects.Image)(this.scene,1*t-t,1*t-t,"main_mig"),s.setScale(.6),this.radar_mig.add(s),this.radar_mig.visible=!1,this.skill_flat_container.add(this.radar_mig),this.submarine_mig=new(a().GameObjects.Container)(this.scene,1.5*t-5*t,.5*t-5*t),s=new(a().GameObjects.Image)(this.scene,1*t-t,1*t-t,"main_mig"),s.setScale(.6,.2),this.submarine_mig.add(s),this.submarine_mig.visible=!1,this.skill_flat_container.add(this.submarine_mig),this.fighter_mig=new(a().GameObjects.Container)(this.scene,2.5*t-5*t,1.5*t-5*t),s=new(a().GameObjects.Image)(this.scene,2*-t+1.5*t,1*-t+.5*t,"main_mig"),s.setScale(.8,.4),this.fighter_mig.add(s),this.fighter_mig.visible=!1,this.skill_flat_container.add(this.fighter_mig),this.torpedo_mig=new(a().GameObjects.Container)(this.scene,.5*t,3.5*-t),s=new(a().GameObjects.Image)(this.scene,5*-t+4.5*t,1*-t+0*t,"main_mig"),s.setScale(2.05,.2),this.torpedo_mig.add(s),this.torpedo_mig.visible=!1,this.skill_flat_container.add(this.torpedo_mig),this.anim_container=new(a().GameObjects.Container)(this.scene),this.add(this.anim_container);const o=this.scene.make.graphics({});o.fillStyle(0,1),o.fillRect(2*t,0,24*t,y.height);const l=o.createGeometryMask();this.anim_container.setMask(l),this.flash=new(a().GameObjects.Rectangle)(this.scene,y.width/2,y.height/2,y.width,y.height,16777215,1),this.flash.alpha=0,this.add(this.flash)}hit_diapozone(e,t,i,s){let a=!1,n=!1;for(let o=0;o<s;o++)for(let s=0;s<i;s++)n=this.second_player_field.hit(e+s,t+o,!0),n&&(a=!0);return a}anim_bomber(e,t){let i=x.cell_width+2,s=new(a().GameObjects.Image)(this.scene,-300,t*i+this.second_player_field.y+.5*i,"skill_anim","bomber_0");s.setAngle(90),s.scale=1.2,this.anim_container.add(s),this.scene.tweens.add({targets:s,x:e*i+this.second_player_field.x-i,duration:3e3,onComplete:()=>{let i=this.hit_diapozone(e-1,t-1,4,4);this.scene.tweens.add({targets:s,x:y.width+300,duration:3e3,onComplete:()=>{this.second_player_field.hit_callback(i),s.destroy()}})}})}anim_submarine(e,t){let i=new(a().GameObjects.Sprite)(this.scene,y.width/2,this.second_player_field.y+(t+.5)*this.cell_width,"skill_anim","submarine_0");i.setAngle(90);let s=new(a().GameObjects.Image)(this.scene,this.second_player_field.x+(e+1.5)*this.cell_width,this.second_player_field.y+(t+.5)*this.cell_width,"skill_anim","torpedo_down");s.visible=!1,s.setAngle(-90);let n=new(a().GameObjects.Image)(this.scene,this.second_player_field.x+(e+.5)*this.cell_width,this.second_player_field.y+(t+.5)*this.cell_width,"skill_anim","torpedo_down");n.visible=!1,n.setAngle(90),this.anim_container.add(n),this.anim_container.add(s),this.anim_container.add(i);let o=t-1;const l=t=>{o>0?this.scene.tweens.add({targets:s,y:`-=${this.cell_width}`,duration:300,onComplete:()=>{let i=!1;i=this.second_player_field.hit(e+1,o,!0),o--,i&&(o=-1),l(t+1)}}):this.scene.tweens.add({targets:s,alpha:0,duration:100,onComplete:()=>{o>-1&&this.second_player_field.hit(e+1,o,!0)}})};let h=t+1;const r=t=>{h<9?this.scene.tweens.add({targets:n,y:`+=${this.cell_width}`,duration:300,onComplete:()=>{let i=!1;i=this.second_player_field.hit(e,h,!0),h++,i&&(h=10),r(t+1)}}):this.scene.tweens.add({targets:n,alpha:0,duration:100,onComplete:()=>{h<10&&this.second_player_field.hit(e,h,!0)}})};this.scene.tweens.add({targets:i,x:this.second_player_field.x+(e+.5)*this.cell_width,duration:300*e+400,onComplete:()=>{this.scene.tweens.add({targets:this.second_player_field,alpha:.5,duration:500}),i.once("animationcomplete",(()=>{s.visible=!0,n.visible=!0,l(0),r(0),setTimeout((()=>{this.scene.tweens.add({targets:this.second_player_field,alpha:1,duration:500}),i.once("animationcomplete",(()=>{this.scene.tweens.add({targets:i,x:y.width+100,duration:3e3})})),i.play("submarine_down")}),1e3)})),i.play("submarine_up")}})}anim_atom(e,t){let i,s=x.cell_width+2,n=new(a().GameObjects.Image)(this.scene,-300,t*s+this.second_player_field.y+1.5*s,"skill_anim","bomber_0");n.setAngle(90),n.scale=1.2,this.anim_container.add(n),this.scene.tweens.add({targets:n,x:e*s+this.second_player_field.x-s,duration:3e3,onComplete:()=>{let o;i=new(a().GameObjects.Image)(this.scene,(e+1.5)*s+this.second_player_field.x,(t+1.5)*s+this.second_player_field.y,"under_explo"),i.scale=0,this.anim_container.add(i);let l=new(a().GameObjects.Sprite)(this.scene,(e+1.5)*s+this.second_player_field.x,(t+1.5)*s+this.second_player_field.y,"skill_anim","atom_explo_0");l.once("animationcomplete",(()=>{o=this.hit_diapozone(e-1,t-1,5,5),i=new(a().GameObjects.Image)(this.scene,(e+1.5)*s+this.second_player_field.x,(t+1.5)*s+this.second_player_field.y,"after_explo"),this.add(i),this.bringToTop(this.anim_container),this.scene.tweens.add({targets:l,alpha:0,duration:1e3,onComplete:()=>{l.destroy()}})})),this.anim_container.add(l),this.anim_container.sendToBack(l),this.scene.tweens.add({targets:i,scale:1,duration:100}),this.scene.tweens.add({targets:this.flash,duration:200,alpha:1,onComplete:()=>{i.destroy(),this.shake.shake(),setTimeout((()=>l.play("atom_explo")),1e3),this.scene.tweens.add({targets:this.flash,delay:1e3,duration:500,alpha:0,onComplete:()=>{}})}}),this.scene.tweens.add({targets:n,x:y.width+300,duration:3e3,onComplete:()=>{this.second_player_field.hit_callback(o),n.destroy()}})}})}anim_radar(e,t){let i,s,n=x.cell_width+2,o=[],l=new(a().GameObjects.Image)(this.scene,(e+.5)*n+this.second_player_field.x,(t+.5)*n+this.second_player_field.y,"skill_anim","radar_back");l.scale=.6,l.alpha=0,this.anim_container.add(l);let h=new(a().GameObjects.Image)(this.scene,(e+.5)*n+this.second_player_field.x,(t+.5)*n+this.second_player_field.y,"skill_anim","radar_arrow");h.setOrigin(0,0),h.scale=.6,h.alpha=0,this.anim_container.add(h),this.scene.tweens.add({targets:[l,h],alpha:1,duration:300}),this.scene.tweens.add({targets:[h],angle:720,duration:1e3,onComplete:()=>{this.scene.tweens.add({targets:[h],angle:720,duration:1e3}),this.scene.tweens.add({targets:[l,h],alpha:0,duration:300,onComplete:()=>{for(let l=t-1;l<t+2;l++)for(let t=e-1;t<e+2;t++)i=this.second_player_field.get_cell(t,l,!0),i&&i.succ&&(s=new(a().GameObjects.Image)(this.scene,t*n+16.5*n,l*n+5.5*n,"cell_false"),s.setTint(65280),s.alpha=0,this.add(s),o.push(s));this.scene&&this.scene.tweens.add({targets:o,alpha:1,duration:300,onComplete:()=>{this.scene&&this.scene.tweens.add({targets:o,alpha:0,delay:1e3,duration:300,onComplete:()=>{o.forEach((e=>e.destroy()))}})}})}})}})}anim_airdef(e,t){let i=new(a().GameObjects.Container)(this.scene,e?0:y.width,y.height+300);this.add(i);let s=new(a().GameObjects.Image)(this.scene,0,0,"skill_anim","airdef_back");s.setOrigin(e?0:1,1),i.add(s);let n=new(a().GameObjects.Image)(this.scene,e?80:-80,-30,"skill_anim","airdef");n.setFlipX(!e),n.setOrigin(e?1:0,1),i.add(n);const o=()=>{for(let i=0;i<8;i++){let i=a().Math.Between(0,9),s=a().Math.Between(t-1,t+1);setTimeout((()=>{let t=new(a().GameObjects.Sprite)(this.scene,(i+.5+(e?16:2))*this.cell_width,(s+5.5)*this.cell_width,"explo_3");t.on("animationcomplete",(()=>{t.destroy()})),t.alpha=.7,this.anim_container.add(t),t.play("shot")}),a().Math.Between(0,1500))}};this.scene.tweens.add({targets:i,y:y.height,delay:1e3,duration:500,onComplete:()=>{o(),this.scene.tweens.add({targets:i,y:y.height+300,delay:1500,duration:500})}})}anim_fighter(e,t){let i=x.cell_width+2,s=x.game_play.fields[1].airdef.includes(t),n=new(a().GameObjects.Container)(this.scene,-300,t*i+this.second_player_field.y-.5*i),o=new(a().GameObjects.Sprite)(this.scene,0,0,"skill_anim","fighter_0");o.scale=1.2,n.add(o),n.setAngle(90),this.anim_container.add(n),s?(this.anim_airdef(!1,t),this.scene.tweens.add({targets:n,x:7.5*i+this.first_player_field.x,duration:2500,onComplete:()=>{o.once("animationcomplete",(()=>{})),this.scene.tweens.add({targets:n,x:10.5*i+this.first_player_field.x,scale:.2,duration:1e3,onComplete:()=>{let e=new(a().GameObjects.Sprite)(this.scene,n.x,n.y,"splash_1");e.scale=.7,e.on("animationcomplete",(()=>{this.second_player_field.hit_callback(!1),e.destroy})),this.anim_container.add(e),e.play("splash"),o.destroy()}}),o.play("fighter_broke")}})):this.scene.tweens.add({targets:n,x:5*i+this.first_player_field.x,duration:1500,onComplete:()=>{o.once("animationcomplete",(()=>{})),this.scene.tweens.add({targets:n,x:e*i+this.second_player_field.x-i,duration:1500,onComplete:()=>{console.log("pih pah"),o.once("animationcomplete",(()=>{}));let i=this.hit_diapozone(e-1,t-1,4,2);this.scene.tweens.add({targets:n,x:y.width+300,duration:1500,onComplete:()=>{this.second_player_field.hit_callback(i),o.destroy()}}),o.play("fighter_up")}}),o.play("fighter_down")}})}anim_torpedo(e){let t=x.cell_width+2,i=new(a().GameObjects.Image)(this.scene,this.second_player_field.x-50,(e+.5)*t+this.second_player_field.y,"skill_anim","torpedo_up"),s=new(a().GameObjects.Image)(this.scene,-300,(e+.5)*t+this.second_player_field.y,"skill_anim","torpedo_0");s.setAngle(90),s.scale=1.2,i.scale=1.2,i.visible=!1,this.anim_container.add(i),this.anim_container.add(s);let n=0;const o=s=>{n<9?this.scene.tweens.add({targets:i,x:`+=${t}`,duration:300,onComplete:()=>{let t=!1;t=this.second_player_field.hit(n,e,!0),n++,t&&(n=10),o(s+1)}}):this.scene.tweens.add({targets:i,alpha:0,duration:100,onComplete:()=>{n<10&&this.second_player_field.hit(n,e,!0)}})};this.scene.tweens.add({targets:s,x:this.second_player_field.x-50,duration:3e3,onComplete:()=>{i.visible=!0,o(0),this.scene.tweens.add({targets:i,duration:300,x:this.second_player_field.x+.5*t,scale:1,onComplete:()=>{i.setFrame("torpedo_down")}}),this.scene.tweens.add({targets:s,x:y.width+300,duration:3e3,onComplete:()=>{s.destroy()}})}})}clear_field(){this.first_player_field&&this.first_player_field.destroy(),this.second_player_field&&this.second_player_field.destroy()}set_timer(e){let t=30;this.turn_timer.text=t.toString(),this.timer=this.scene.time.addEvent({delay:1e3,callback:()=>{t--,t>0?this.turn_timer.text=t.toString():(this.stop_timer(),this.flip_arrow(!e,(()=>{e?x.game_play.with_bot?this.bot_turn():this.first_player_field.on_turn():x.game_play.with_bot?this.bot_turn():this.check_endgame()&&this.second_player_field.on_turn()})))},callbackScope:this,repeat:29})}flip_arrow(e,t){this.timer&&this.timer.remove(),e!==this.turn_arrow.flipX?this.scene.tweens.add({targets:this.turn_arrow,duration:100,scaleX:0,onComplete:()=>{this.turn_arrow.setFlipX(e),this.scene.tweens.add({targets:this.turn_arrow,duration:100,scaleX:1,onComplete:()=>{t(),this.set_timer(e)}})}}):(t(),this.set_timer(e))}stop_timer(){this.timer&&this.timer.remove(),this.turn_timer.text=""}init(e){this.scene.anims.create({key:"explo",frames:[{key:"explo_1"},{key:"explo_2"},{key:"explo_3"},{key:"explo_4"},{key:"explo_5"},{key:"explo_6"},{key:"explo_7"}],frameRate:16,showOnStart:!0,hideOnComplete:!0}),this.scene.anims.create({key:"shot",frames:[{key:"explo_3"},{key:"explo_4"},{key:"explo_5"},{key:"explo_6"},{key:"explo_7"}],frameRate:16,showOnStart:!0,hideOnComplete:!0}),this.scene.anims.create({key:"splash",frames:[{key:"splash_1"},{key:"splash_2"},{key:"splash_3"},{key:"splash_4"},{key:"splash_5"},{key:"splash_6"}],frameRate:16,showOnStart:!0,hideOnComplete:!0}),this.scene.anims.create({key:"fighter_broke",frames:[{key:"skill_anim",frame:"fighter_6"},{key:"skill_anim",frame:"fighter_7"},{key:"skill_anim",frame:"fighter_8"},{key:"skill_anim",frame:"fighter_9"},{key:"skill_anim",frame:"fighter_10"},{key:"skill_anim",frame:"fighter_11"},{key:"skill_anim",frame:"fighter_12"}],frameRate:6}),this.scene.anims.create({key:"fighter_down",frames:[{key:"skill_anim",frame:"fighter_0"},{key:"skill_anim",frame:"fighter_1"},{key:"skill_anim",frame:"fighter_2"},{key:"skill_anim",frame:"fighter_3"}],frameRate:6}),this.scene.anims.create({key:"fighter_up",frames:[{key:"skill_anim",frame:"fighter_3"},{key:"skill_anim",frame:"fighter_4"},{key:"skill_anim",frame:"fighter_5"},{key:"skill_anim",frame:"fighter_0"}],frameRate:6}),this.scene.anims.create({key:"atom_explo",frames:[{key:"skill_anim",frame:"atom_explo_1"},{key:"skill_anim",frame:"atom_explo_2"},{key:"skill_anim",frame:"atom_explo_3"},{key:"skill_anim",frame:"atom_explo_4"},{key:"skill_anim",frame:"atom_explo_5"},{key:"skill_anim",frame:"atom_explo_6"}],frameRate:6}),this.scene.anims.create({key:"submarine_up",frames:[{key:"skill_anim",frame:"submarine_0"},{key:"skill_anim",frame:"submarine_1"},{key:"skill_anim",frame:"submarine_2"},{key:"skill_anim",frame:"submarine_3"},{key:"skill_anim",frame:"submarine_4"}],frameRate:6}),this.scene.anims.create({key:"submarine_down",frames:[{key:"skill_anim",frame:"submarine_4"},{key:"skill_anim",frame:"submarine_3"},{key:"skill_anim",frame:"submarine_2"},{key:"skill_anim",frame:"submarine_1"},{key:"skill_anim",frame:"submarine_0"}],frameRate:6});let t=1*x.cell_width+2;this.cell_width=t,this.create_back(),this.first_bg=this.create_field(2*t,t),this.add(this.first_bg),this.second_bg=this.create_field(16*t,t),this.add(this.second_bg),this.turn_arrow=new(a().GameObjects.Image)(this.scene,14*t,10*t,"game_play","turn_arrow"),this.add(this.turn_arrow),this.turn_timer=new(a().GameObjects.Text)(this.scene,this.turn_arrow.x,this.turn_arrow.y,"",{fontFamily:"rubik",fontSize:"36",strokeThickness:4,stroke:"#051F79"}),this.turn_timer.setOrigin(.5),this.add(this.turn_timer),this.create_profiles(t),this.home_button=new j(this.scene,{x:14*this.cell_width,y:14*this.cell_width+7,atlas:"new",frame_out:"mini_button",callback:()=>{u.windows_manager.show_window("quit_battle")}});let i=new(a().GameObjects.Image)(this.scene,0,-17,"new","home_icon");this.home_button.add(i);let s=new(a().GameObjects.Text)(this.scene,0,42,"HOME",{fontFamily:"rubik",fontSize:"21"});s.setOrigin(.5),this.home_button.add(s),this.add(this.home_button),this.chat_button=new j(this.scene,{x:14*this.cell_width,y:3*this.cell_width+7,atlas:"new",frame_out:"mini_button",callback:()=>{}}),i=new(a().GameObjects.Image)(this.scene,0,-17,"new","chat_icon"),this.chat_button.add(i),s=new(a().GameObjects.Text)(this.scene,0,42,"CHAT",{fontFamily:"rubik",fontSize:"21"}),s.setOrigin(.5),this.chat_button.add(s),this.chat_button.alpha=.7,this.add(this.chat_button),this.arsenal_button=new j(this.scene,{x:14*t,y:6*t+7,atlas:"new",frame_out:"mini_button",callback:()=>this.show_arsenal()}),i=new(a().GameObjects.Image)(this.scene,0,-17,"new","arsenal_icon"),this.arsenal_button.add(i),s=new(a().GameObjects.Text)(this.scene,0,42,"ARSENAL",{fontFamily:"rubik",fontSize:"21"}),s.setOrigin(.5),this.arsenal_button.add(s),this.add(this.arsenal_button)}create_arsenal(){let e,t=x.cell_width+2;this.arsenal_container=new(a().GameObjects.Container)(this.scene,0,0),this.arsenal_container.setSize(2*y.width,2*y.height),this.arsenal_container.setInteractive(),this.arsenal_container.on("pointerdown",(()=>this.hide_arsenal())),this.arsenal_container.setVisible(!1),this.add(this.arsenal_container),this.arsenal_slider=new S(this.scene,{background:{frame:"arsenal_slider"}}),this.arsenal_slider.setXY(8*t,8.5*t),this.arsenal_container.add(this.arsenal_slider),["atom","bomber","torpedo","fighter","radar"].forEach(((i,s)=>{e=new(a().GameObjects.Image)(this.scene,4.6*t,s*t*4+1.8*t,"skill_item"),this.arsenal_slider.add_child(e),e.setInteractive(),e.on("pointerdown",(()=>{this.arsenal_slider.pointer_down=!0})),e.on("pointerup",(()=>{this.arsenal_slider.was_move?this.arsenal_slider.was_move=!1:(this.start_skill(i),this.hide_arsenal()),this.arsenal_slider.pointer_down=!1})),e.on("pointerout",(()=>{this.arsenal_slider.pointer_down=!1,this.arsenal_slider.was_move=!1})),e.on("pointermove",(e=>{this.arsenal_slider.emit("pointermove",e)})),e=new(a().GameObjects.Image)(this.scene,e.x,e.y+25,"skill_"+i),this.arsenal_slider.add_child(e),e=new(a().GameObjects.Text)(this.scene,e.x-200,e.y+50,`${x.user_data.skills[i].amount}`,{fontSize:"24",strokeThickness:4,stroke:"#70fg09"}),e.setOrigin(.5,.5),this.arsenal_slider.add_child(e)}));let i=new j(this.scene,{x:14*t,y:6*t+7,atlas:"new",frame_out:"mini_button",callback:()=>this.show_arsenal()});e=new(a().GameObjects.Image)(this.scene,0,-17,"new","arsenal_icon"),i.add(e),this.add(i)}start_skill(e){x.user_data.skills[e].amount>0&&(x.user_data.skills[e].amount--,this.skill_flat_active=!0,this.skill_flat_container.visible=!0,"bomber"===e?(this.skill_name="bomber",this.bomber_mig.visible=!0):"atom"===e?(this.skill_name="atom",this.atom_mig.visible=!0):"fighter"===e?(this.skill_name="fighter",this.fighter_mig.visible=!0):"torpedo"===e?(this.skill_name="torpedo",this.torpedo_mig.visible=!0):"radar"===e?(this.skill_name="radar",this.radar_mig.visible=!0):"submarine"===e&&(this.skill_name="submarine",this.submarine_mig.visible=!0))}show_arsenal(){u.windows_manager.show_window("arsenal")}hide_arsenal(){}create_profiles(e){let t,i,s=new(a().GameObjects.Container)(this.scene,2.65*e,2.35*e);this.add(s);let n=new(a().GameObjects.Image)(this.scene,0,0,"new","profile_ava"),o=new(a().GameObjects.Text)(this.scene,4.35*e,.12*e,x.user_data.name.toUpperCase(),{fontSize:"28",fontFamily:"rubik",color:"#051F79"});o.setOrigin(.5,.5),t=new(a().GameObjects.Image)(this.scene,1.85*e,.12*e,"new","micro_plank"),s.add(t),t=new(a().GameObjects.Image)(this.scene,1.85*e,1.15*e,"new","micro_plank"),s.add(t),t=new(a().GameObjects.Image)(this.scene,1.85*e,.12*e,"new","flag_micro"),s.add(t),t=new(a().GameObjects.Image)(this.scene,1.85*e,1.15*e,"new","rank_micro"),s.add(t),t=new(a().GameObjects.Image)(this.scene,4.35*e,.12*e,"new","plank_frame"),s.add(t),t=new(a().GameObjects.Image)(this.scene,4.35*e,1.15*e,"new","plank_frame"),s.add(t),i=new(a().GameObjects.Text)(this.scene,4.35*e,1.15*e,x.user_data.rank.stage.toUpperCase(),{fontFamily:"rubik",fontSize:"28",color:"#051F79"}),i.setOrigin(.5),s.add(i),t=new(a().GameObjects.Image)(this.scene,6.85*e,.12*e,"new","micro_plank"),s.add(t),t=new(a().GameObjects.Image)(this.scene,6.85*e,1.15*e,"new","micro_plank"),s.add(t),t=new(a().GameObjects.Image)(this.scene,6.85*e,.12*e,"new","rating_micro_icon"),s.add(t),t=new(a().GameObjects.Image)(this.scene,6.85*e,1.15*e,"new","oil_icon"),s.add(t),t=new(a().GameObjects.Image)(this.scene,8.35*e,.12*e,"new","plank_frame_mini"),s.add(t),i=new(a().GameObjects.Text)(this.scene,8.35*e,.12*e,x.user_data.rating.score.toString().toUpperCase(),{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),i.setOrigin(.5),s.add(i),t=new(a().GameObjects.Image)(this.scene,8.35*e,1.15*e,"new","plank_frame_mini"),s.add(t),i=new(a().GameObjects.Text)(this.scene,8.35*e,1.15*e,x.user_data.oil.amount.toString().toUpperCase(),{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),i.setOrigin(.5),s.add(i),s.add([n,o]);let l=new(a().GameObjects.Container)(this.scene,25.3*e,2.35*e);this.add(l);let h=new(a().GameObjects.Image)(this.scene,0,0,"new","profile_ava");h.setFlipX(!0);let r=new(a().GameObjects.Text)(this.scene,-4.35*e,.12*e,"Bot".toUpperCase(),{fontSize:"28",fontFamily:"rubik",color:"#051F79"});r.setOrigin(.5),t=new(a().GameObjects.Image)(this.scene,-1.85*e,.12*e,"new","micro_plank"),l.add(t),t=new(a().GameObjects.Image)(this.scene,-1.85*e,1.15*e,"new","micro_plank"),l.add(t),t=new(a().GameObjects.Image)(this.scene,-1.85*e,.12*e,"new","flag_micro"),l.add(t),t=new(a().GameObjects.Image)(this.scene,-1.85*e,1.15*e,"new","rank_micro"),l.add(t),t=new(a().GameObjects.Image)(this.scene,-4.35*e,.12*e,"new","plank_frame"),l.add(t),t=new(a().GameObjects.Image)(this.scene,-4.35*e,1.15*e,"new","plank_frame"),l.add(t),i=new(a().GameObjects.Text)(this.scene,-4.35*e,1.15*e,x.user_data.rank.stage.toUpperCase(),{fontFamily:"rubik",fontSize:"28",color:"#051F79"}),i.setOrigin(.5),l.add(i),t=new(a().GameObjects.Image)(this.scene,-6.85*e,.12*e,"new","micro_plank"),l.add(t),t=new(a().GameObjects.Image)(this.scene,-6.85*e,.12*e,"new","rating_micro_icon"),l.add(t),t=new(a().GameObjects.Image)(this.scene,-8.35*e,.12*e,"new","plank_frame_mini"),l.add(t),i=new(a().GameObjects.Text)(this.scene,-8.35*e,.12*e,(x.user_data.rating.score+Math.floor(100*(Math.random()-Math.random()))).toString().toUpperCase(),{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),i.setOrigin(.5),l.add(i),l.add([h,r])}create_field(e,t){let i,s=new(a().GameObjects.Container)(this.scene,e,5*t),n=new(a().GameObjects.Graphics)(this.scene);n.fillStyle(16777215,0);let o,l=10*t,h=10*t;return n.fillRect(0,0,l,h),s.add(n),i=new(a().GameObjects.Image)(this.scene,5*t,5*t,"new","field_frame"),i.setScale(1.05),s.add(i),["A","B","C","D","E","F","G","H","I","J"].forEach(((i,n)=>{o=new(a().GameObjects.Text)(this.scene,e<y.width/2?-.5*t:10.5*t,.5*t+t*n,i,{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),o.setOrigin(.5),s.add(o),o=new(a().GameObjects.Text)(this.scene,.5*t+t*n,-.5*t,n.toString(),{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),o.setOrigin(.5),s.add(o)})),s}handler_close(){}}class X extends a().GameObjects.Container{constructor(e,t){super(e),this.name="prepare_field",this.init(t)}create_back(){this.cell_width=x.cell_width,this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(0,0,y.width,y.height);let e=Math.ceil(y.height/this.cell_width),t=Math.ceil(y.width/this.cell_width);this.bg.lineStyle(2,6386084,.7);for(let t=0;t<=e;t++)this.bg.lineBetween(0,t*this.cell_width,y.width,t*this.cell_width);for(let e=0;e<=t;e++)this.bg.lineBetween(e*this.cell_width,0,e*this.cell_width,y.height);this.bg.lineStyle(7,13582392,.9),this.bg.lineBetween(0,3*this.cell_width,y.width,3*this.cell_width),this.add(this.bg)}show(e={}){x.game_play.fields.length>0?this.ships=x.game_play.fields[0].ships:this.ships=[],this.fill_ships(x.cell_width)}create_bar(){let e=x.cell_width,t=new(a().GameObjects.Image)(this.scene,17.5*e,3.5*e,"game_play","oil_icon");this.oil_bar=new n(this.scene,{atlas:"new",frame_bar:"oil_progress"}),this.oil_bar.setPosition(22*e,3.5*e),this.oil_bar.scaleX=1.02,this.dot_oil_button=new j(this.scene,{x:26.5*e,y:3.5*e,atlas:"new",frame_out:"button_plus",callback:()=>{x.user_data.oil.amount=x.user_data.oil.max,this.update_oil()}}),this.oil_txt=new(a().GameObjects.Text)(this.scene,this.oil_bar.x,this.oil_bar.y,"",{fontFamily:"rubik",fontSize:"36",strokeThickness:4,stroke:"#072279"}),this.oil_txt.setOrigin(.5),this.update_oil(),this.add([t,this.oil_bar,this.dot_oil_button,this.oil_txt])}update_oil(){this.oil_bar.update_progress(x.user_data.oil.amount/x.user_data.oil.max),this.oil_txt.text=`${x.user_data.oil.amount} / ${x.user_data.oil.max}`}create_arsenal(){let e,t=x.cell_width;this.arsenal_slider=new S(this.scene,{width:11*t,height:9*t}),this.arsenal_slider.setXY(22.15*t,8.45*t),this.add(this.arsenal_slider),this.skill_txts={},["atom","bomber","torpedo","fighter","airdef","submarine","radar","mine"].forEach(((i,s)=>{e=new(a().GameObjects.Image)(this.scene,4.6*t,s*t*4+1.8*t,"skill_item"),this.arsenal_slider.add_child(e),e.setInteractive(),e.on("pointerdown",(()=>{this.arsenal_slider.pointer_down=!0})),e.on("pointerup",(()=>{this.arsenal_slider.was_move?this.arsenal_slider.was_move=!1:"airdef"===i||"mine"===i?this.start_skill(i):this.handler_buy(i),this.arsenal_slider.pointer_down=!1})),e.on("pointerout",(()=>{this.arsenal_slider.pointer_down=!1,this.arsenal_slider.was_move=!1})),e.on("pointermove",(e=>{this.arsenal_slider.emit("pointermove",e)})),e=new(a().GameObjects.Image)(this.scene,e.x,e.y+25,"skill_"+i),this.arsenal_slider.add_child(e),e=new(a().GameObjects.Text)(this.scene,e.x-230,e.y+50,`${x.user_data.skills[i].amount}/${x.skills[i].max}`,{fontFamily:"rubik",fontSize:"36",color:"#072279"}),e.setOrigin(.5,.5),this.arsenal_slider.add_child(e),this.skill_txts[i]=e,e=new(a().GameObjects.Text)(this.scene,e.x+460,e.y,`${x.skills[i].price}`,{fontFamily:"rubik",fontSize:"36",color:"#072279"}),e.setOrigin(.5),this.arsenal_slider.add_child(e),e=new(a().GameObjects.Image)(this.scene,e.x-80,e.y,"oil_can"),e.scale=.7,this.arsenal_slider.add_child(e)}))}handler_buy(e){let t=x.user_data.skills,i=x.skills,s=x.user_data.oil,a=i[e].price;t[e].amount+1<=i[e].max&&s.amount>=a&&(s.amount-=a,t[e].amount++),this.update_skill_amount(e),this.update_oil()}update_skill_amount(e){this.skill_txts[e].text=`${x.user_data.skills[e].amount}/${x.skills[e].max}`}fill_ships(e){let t,i;this.ships.forEach(((s,n)=>{i=s.y_l>s.x_l,t=new(a().GameObjects.Image)(this.scene,e/2+s.x*e+3*e,e/2+s.y*e+5*e,"ship_"+(i?s.y_l+1:s.x_l+1)),t.scale=e*(i?s.y_l+1:s.x_l+1)/t.width,t.setOrigin(e/2/(t.width*t.scale),.5),t.setAngle(i?90:0),this.add(t)}))}update_buttons(){}create_buttons(e,t){let i,s;this.video_button=new j(this.scene,{x:15*t,y:11*t+7,atlas:"game_play",frame_out:"mini_button",callback:()=>{u.windows_manager.show_window("video_oil")}}),i=new(a().GameObjects.Image)(this.scene,-5,-17,"new","oil_icon_dark"),this.video_button.add(i),s=new(a().GameObjects.Text)(this.scene,0,42,"+600",{fontFamily:"rubik",fontSize:"30",color:"#2BFF2B"}),s.setOrigin(.5),this.video_button.add(s),this.add(this.video_button),this.restart_button=new j(this.scene,{x:15*t,y:14*t+7,atlas:"game_play",frame_out:"mini_button",callback:()=>{x.user_data.oil.amount=x.user_data.oil.max,this.update_oil(),Object.keys(x.user_data.skills).forEach((e=>{x.user_data.skills[e].amount=0,this.update_skill_amount(e)}))}}),i=new(a().GameObjects.Image)(this.scene,0,-17,"game_play","rotate_icon"),this.restart_button.add(i),s=new(a().GameObjects.Text)(this.scene,0,42,"AUTO",{fontFamily:"rubik",fontSize:"21"}),s.setOrigin(.5),this.restart_button.add(s),this.add(this.restart_button),this.play_button=new j(this.scene,{x:16*t+6*t,y:14*t,frame_out:"next_play_button",callback:()=>{u.game_play.update_scenes("game_play")}}),s=new(a().GameObjects.Text)(this.scene,0,0,"BATTLE",{fontFamily:"rubik",fontSize:"64"}),s.setOrigin(.5),this.play_button.add(s),this.add(this.play_button)}init(e){let t=1*x.cell_width;this.create_back();let i=new(a().GameObjects.Image)(this.scene,8*t,3.5*t+2,"new","plank");i.scale=10*t/i.width,this.add(i);let s=new(a().GameObjects.Text)(this.scene,8*t,3.5*t+2,"SEA MAP",{fontFamily:"rubik",fontSize:"36"});s.setOrigin(.5),this.add(s),i=new(a().GameObjects.Image)(this.scene,22*t,3.5*t+2,"new","plank"),i.scale=10*t/i.width,this.add(i),this.create_field(t),this.create_bar(),this.create_arsenal(),this.create_buttons(1,t),this.create_skill_flat()}handler_close(){}create_skill_flat(){let e=x.cell_width;this.skill_flat_active=!0,this.skill_name="torpedo",this.skill_flat_container=new(a().GameObjects.Container)(this.scene,3*e,5*e),this.add(this.skill_flat_container),this.skill_flat_container.visible=!1;let t=new(a().GameObjects.Rectangle)(this.scene,5*e,5*e,10*e,10*e,16777215,1);t.alpha=.3,t.visible=!0,this.skill_flat_container.add(t),t.setInteractive();let i=!1;t.on("pointerdown",(()=>{this.skill_flat_active&&(i=!0)})).on("pointerup",(t=>{if(this.skill_flat_active){i=!1;let s=Math.floor((t.position.y-this.skill_flat_container.y)/e),a=Math.floor((t.position.x-this.skill_flat_container.x)/e);"airdef"===this.skill_name?(x.game_play.fields[0].airdef.push(s,s+1),this.handler_buy("airdef")):"mine"===this.skill_name&&(x.game_play.fields[0].mine.push({x:a,y:s}),this.handler_buy("mine")),this.skill_flat_active=!1,this.skill_flat_container.visible=!1}})).on("pointerout",(()=>{this.skill_flat_active&&(i=!1)})).on("pointermove",(t=>{if(i&&this.skill_flat_active){let i=Math.floor((t.position.y-this.skill_flat_container.y)/e),s=Math.floor((t.position.x-this.skill_flat_container.x)/e);"airdef"===this.skill_name?(i<0&&(i=0),i>8&&(i=8),this.airdef_mig.y=1*e+e*i):"mine"===this.skill_name&&(i<0&&(i=0),i>9&&(i=9),this.mine_mig.y=.5*e+e*i,this.mine_mig.x=.5*e+e*s)}})),this.airdef_mig=new(a().GameObjects.Image)(this.scene,5*e,1*e,"main_mig"),this.airdef_mig.setScale(2,.4),this.airdef_mig.visible=!1,this.skill_flat_container.add(this.airdef_mig),this.mine_mig=new(a().GameObjects.Image)(this.scene,.5*e,.5*e,"skill_anim","mine"),this.mine_mig.setScale(.8),this.mine_mig.visible=!1,this.skill_flat_container.add(this.mine_mig)}start_skill(e){this.skill_flat_active=!0,this.skill_flat_container.visible=!0,"airdef"===e&&(this.skill_name="airdef",this.airdef_mig.visible=!0),"mine"===e&&(this.skill_name="mine",this.mine_mig.visible=!0)}create_field(e){let t;this.field_frame=new(a().GameObjects.Graphics)(this.scene),this.field_frame.fillStyle(16777215,0);let i,s=3*e,n=3.5*e,o=10*e,l=10*e;this.field_frame.fillRect(s,n,o,l),this.add(this.field_frame),t=new(a().GameObjects.Image)(this.scene,8*e,10*e,"new","field_frame"),t.setScale(1.02),this.add(t),["A","B","C","D","E","F","G","H","I","J"].forEach(((t,s)=>{i=new(a().GameObjects.Text)(this.scene,2.5*e,5.5*e+e*s,t,{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),i.setOrigin(.5),this.add(i),i=new(a().GameObjects.Text)(this.scene,3.5*e+e*s,4.5*e,s.toString(),{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),i.setOrigin(.5),this.add(i)}))}}class U{constructor(){this.field=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],this.ships=[]}get_filling(){let e=0;return this.field.forEach((t=>{t.forEach((t=>{1===t&&e++}))})),e}is_posible(e,t,i){let s;return s=i?this.field[t]&&0===this.field[t][e]:!this.field[t]||!this.field[t][e]||1!==this.field[t][e],s}is_posible_ship(e,t,i,s){let a=!0,n=e+i,o=t+s;for(let l=t-1;l<t+s+2;l++)for(let h=e-1;h<e+i+2;h++){let r=l>=t&&l<t+s&&(s>0||l===t)&&h>=e&&h<e+i&&(i>0||h===e);(!this.is_posible(h,l,r)||n>9||o>9)&&(a=!1)}return a}update_field(){this.clear_field(),this.ships.forEach((e=>{this.add_ship(e,!0)}))}remove_ship(e){let{x:t,y:i,x_l:s,y_l:a}=e,n=-1;this.ships.forEach(((e,o)=>{e.x==t&&e.y==i&&e.x_l==s&&e.y_l==a&&(n=o)})),-1!==n?(this.ships.splice(n,1),this.update_field()):(console.trace(this.ships),console.trace(e),console.trace("Ship not found"))}clear_ships(){this.ships=[]}clear_field(){this.field=[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]]}clear(){this.clear_field(),this.clear_ships()}add_ship(e,t){let{x:i,y:s,x_l:a,y_l:n}=e;if(this.is_posible_ship(i,s,a,n)){let e=!0;for(let t=s;t<=s+n;t++)for(let s=i;s<=i+a;s++)t>=0&&t<=9&&s>=0&&s<=9?this.field[t][s]=1:e=!1;let o=-1;return this.ships.forEach(((e,t)=>{e.x==i&&e.y==s&&e.x_l==a&&e.y_l==n&&(o=t)})),e&&-1===o&&!t&&this.ships.push({x:i,y:s,x_l:a,y_l:n}),!0}return!1}}class V extends a().GameObjects.Container{constructor(e,t){super(e),this.name="prepare_field",this.init(t)}create_back(){this.cell_width=x.cell_width,this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(0,0,y.width,y.height);let e=Math.ceil(y.height/this.cell_width),t=Math.ceil(y.width/this.cell_width);this.bg.lineStyle(2,6386084,.7);for(let t=0;t<=e;t++)this.bg.lineBetween(0,t*this.cell_width,y.width,t*this.cell_width);for(let e=0;e<=t;e++)this.bg.lineBetween(e*this.cell_width,0,e*this.cell_width,y.height);this.bg.lineStyle(7,13582392,.9),this.bg.lineBetween(0,3*this.cell_width,y.width,3*this.cell_width),this.add(this.bg)}show(e={}){this.clear_ships(),this.prepare_frame.clear(),this.update_buttons()}create_drop_zone(e,t){this.drop_zone={x:3*t,y:5*t,width:10*t,height:10*t}}clear_fantoms(){this.fantoms&&this.fantoms.forEach((e=>{e.visible=!1,e.setPosition(0,0)}))}clear_ships(){this.ships&&(this.ships.forEach((e=>{e.destroy()})),this.ships=[]);let e=1*x.cell_width;this.create_ships(1,e)}create_fantoms_ships(e,t){this.fantoms_true=[new(a().GameObjects.Image)(this.scene,0,0,"ship_1_green").setScale(e),new(a().GameObjects.Image)(this.scene,0,0,"ship_2_green").setScale(e),new(a().GameObjects.Image)(this.scene,0,0,"ship_3_green").setScale(e),new(a().GameObjects.Image)(this.scene,0,0,"ship_4_green").setScale(e)],this.fantoms_false=[new(a().GameObjects.Image)(this.scene,0,0,"ship_1_red").setScale(e),new(a().GameObjects.Image)(this.scene,0,0,"ship_2_red").setScale(e),new(a().GameObjects.Image)(this.scene,0,0,"ship_3_red").setScale(e),new(a().GameObjects.Image)(this.scene,0,0,"ship_4_red").setScale(e)],this.fantoms=[...this.fantoms_true,...this.fantoms_false],this.fantoms_of_color={_green:this.fantoms_true,_red:this.fantoms_false},this.fantoms.forEach((e=>{e.setOrigin(t/2/(e.width*e.scale),.5),e.visible=!1})),this.add(this.fantoms)}is_in_dropzone(e,t){return e>this.drop_zone.x&&e<this.drop_zone.x+this.drop_zone.width&&t>this.drop_zone.y&&t<this.drop_zone.y+this.drop_zone.height}catch_stand(e){e.setOrigin(0,1),e.vertical=!1,e.setAngle(0),e.stand=!1,this.last_ship=null,e.x=e.stand_coords.x,e.y=e.stand_coords.y,this.update_buttons()}set_drag_interactive(e,t,i){let s={x:0,y:0},a={x:0,y:0},n={x:e.x+i/2,y:e.y-i/2},o={x:0,y:0};e.stand_coords={x:e.x,y:e.y},e.setInteractive({draggable:!0});let l=!1;e.on("pointerdown",((t,i,a)=>{l=!1,e.stand&&(this.last_ship=e),s.x=i,s.y=a})),e.on("pointerup",(()=>{})),e.on("dragstart",((t,i,s)=>{this.clear_fantoms(),e.stand&&this.prepare_frame.remove_ship({x:e.index_pos.x,y:e.index_pos.y,x_l:e.vertical?0:e.index,y_l:e.vertical?e.index:0}),this.update_buttons()})),e.on("drag",((t,h,r)=>{if(l=!0,this.clear_fantoms(),a.x=t.worldX-s.x+(e.stand?i/2:0),a.y=t.worldY+s.y-(e.stand?i/2:0),e.setPosition(a.x,a.y),n={x:e.x+(e.stand?0:i/2),y:e.y-(e.stand?0:i/2)},this.prepare_frame.update_field(),this.is_in_dropzone(n.x,n.y)){o.x=Math.floor((n.x-this.drop_zone.x)/i),o.y=Math.floor((n.y-this.drop_zone.y)/i);let t={x:o.y+(e.vertical&&e.index>0?e.index:0),y:o.x+(!e.vertical&&e.index>0?e.index:0)};if(t.x>=0&&t.x<=9&&t.y>=0&&t.y<=9){let t=this.prepare_frame.is_posible_ship(o.x,o.y,e.vertical?0:e.index,e.vertical?e.index:0)?"_green":"_red",s=this.fantoms_of_color[t][e.index];s.setPosition(this.drop_zone.x+i/2+o.x*i,this.drop_zone.y+i/2+o.y*i),s.setScale(e.scale),s.setOrigin(i/2/(s.width*s.scale),.5),s.setAngle(e.vertical?90:0),s.visible=!0}else this.clear_fantoms()}else this.clear_fantoms()})),e.on("drop",((e,t,i)=>{t.x=i.x,t.y=i.y,t.input.enabled=!1})),e.on("dragend",((t,s,a)=>{this.clear_fantoms(),n={x:e.x+(e.stand?0:i/2),y:e.y-(e.stand?0:i/2)},this.is_in_dropzone(n.x,n.y)?(o.x=Math.floor((n.x-this.drop_zone.x)/i),o.y=Math.floor((n.y-this.drop_zone.y)/i),this.prepare_frame.add_ship({x:o.x,y:o.y,x_l:e.vertical?0:e.index,y_l:e.vertical?e.index:0})?(e.stand=!0,e.index_pos=o,e.setOrigin(i/2/(e.width*e.scale),.5),e.setPosition(this.drop_zone.x+i/2+o.x*i,this.drop_zone.y+i/2+o.y*i),this.last_ship=e,this.update_buttons()):this.catch_stand(e)):(e.stand&&this.prepare_frame.remove_ship({x:e.index_pos.x,y:e.index_pos.y,x_l:e.vertical?0:e.index,y_l:e.vertical?e.index:0}),this.catch_stand(e))}))}create_ships(e,t){let i,s,n,o,l,h=x.game_play.default_rules;x.game_play.default_rules,this.ships=[];for(let r in h.ships.boats){i={x:26*t,y:12*t},s=h.ships.boats[r],n="ship_",l=parseInt(r),n+=l+1,i.y-=2*l*t;for(let h=0;h<s;h++)o=new(a().GameObjects.Image)(this.scene,i.x-(h+1)*(2+l)*t,i.y,n),o.setOrigin(0,1),o.setScale(t/o.height),o.index=l,o.vertical=!1,this.add(o),this.ships.push(o),this.set_drag_interactive(o,e,t)}}is_rotate_ship(){let e=this.last_ship,t={x:0,y:0,x_l:0,y_l:0},i=!1;if(e){let s=-1;t.x=e.index_pos.x,t.y=e.index_pos.y,t.x_l=e.vertical?0:e.index,t.y_l=e.vertical?e.index:0,this.prepare_frame.ships.forEach(((e,i)=>{e.x==t.x&&e.y==t.y&&e.x_l==t.x_l&&e.y_l==t.y_l&&(s=i)})),s>=0&&(this.prepare_frame.remove_ship({x:t.x,y:t.y,x_l:e.vertical?0:e.index,y_l:e.vertical?e.index:0}),e.vertical=!e.vertical,i=this.prepare_frame.is_posible_ship(t.x,t.y,e.vertical?0:e.index,e.vertical?e.index:0),e.vertical=!e.vertical,this.prepare_frame.add_ship({x:t.x,y:t.y,x_l:e.vertical?0:e.index,y_l:e.vertical?e.index:0}))}return i}rotate_ship(){let e=this.last_ship;e&&(this.prepare_frame.remove_ship({x:e.index_pos.x,y:e.index_pos.y,x_l:e.vertical?0:e.index,y_l:e.vertical?e.index:0}),e.vertical=!e.vertical,e.setAngle(e.vertical?90:0),this.prepare_frame.add_ship({x:e.index_pos.x,y:e.index_pos.y,x_l:e.vertical?0:e.index,y_l:e.vertical?e.index:0}))}is_random(){return 0===this.prepare_frame.ships.length}random_field(){let e,t=1*x.cell_width,i=this.ships.length,s=!1,n=0,o=0;const l=()=>{s=Math.random()>.5,n=a().Math.Between(0,9),o=a().Math.Between(0,9),this.prepare_frame.add_ship({x:n,y:o,x_l:s?0:e.index,y_l:s?e.index:0})?(e.stand=!0,e.index_pos={x:n,y:o},e.setOrigin(t/2/(e.width*e.scale),.5),e.setAngle(s?90:0),e.setPosition(this.drop_zone.x+t/2+n*t,this.drop_zone.y+t/2+o*t),this.last_ship=e,this.update_buttons()):l()};for(let t=i-1;t>=0;t--)e=this.ships[t],l()}random_bot_field(){let e=x.game_play.default_rules,t=!1,i=0,s=0,n=0,o=0,l="";const h=e=>{t=Math.random()>.5,i=a().Math.Between(0,9),s=a().Math.Between(0,9),this.prepare_frame.add_ship({x:i,y:s,x_l:t?0:e,y_l:t?e:0})||h(e)};for(let t in e.ships.boats){n=e.ships.boats[t],o=parseInt(t),l+=o+1;for(let e=0;e<n;e++)h(o)}}update_buttons(){this.is_rotate=this.is_rotate_ship(),this.is_random_field=this.is_random(),this.is_bot=x.game_play.with_bot,this.done_field=this.prepare_frame.get_filling()>=x.game_play.default_rules.filling,this.done_icon.visible=this.done_field,this.random_button.alpha=this.is_random_field?1:.7,this.play_button.alpha=this.done_field?1:.7}create_buttons(e,t){let i,s;this.save_button=new j(this.scene,{x:15*t,y:6*t+7,atlas:"game_play",frame_out:"mini_button",callback:()=>{u.windows_manager.show_window("save_field")}}),i=new(a().GameObjects.Image)(this.scene,0,-17,"game_play","save_icon_dark"),this.save_button.add(i),s=new(a().GameObjects.Text)(this.scene,0,42,"SAVE",{fontFamily:"rubik",fontSize:"21"}),s.setOrigin(.5),this.save_button.add(s),this.add(this.save_button),this.random_button=new j(this.scene,{x:15*t,y:11*t+7,atlas:"game_play",frame_out:"mini_button",callback:()=>{this.is_random()&&this.random_field()}}),i=new(a().GameObjects.Image)(this.scene,0,-17,"new","auto_icon"),this.random_button.add(i),s=new(a().GameObjects.Text)(this.scene,0,42,"AUTO",{fontFamily:"rubik",fontSize:"21"}),s.setOrigin(.5),this.random_button.add(s),this.add(this.random_button),this.reset_button=new j(this.scene,{x:15*t,y:14*t+7,atlas:"game_play",frame_out:"mini_button",callback:()=>{this.is_rotate_ship()&&this.rotate_ship()}}),i=new(a().GameObjects.Image)(this.scene,0,-17,"new","reset_icon"),this.reset_button.add(i),s=new(a().GameObjects.Text)(this.scene,0,42,"ROTATE",{fontFamily:"rubik",fontSize:"21"}),s.setOrigin(.5),this.reset_button.add(s),this.add(this.reset_button),this.play_button=new j(this.scene,{x:this.reset_button.x+7*t,y:this.reset_button.y-7,frame_out:"next_play_button",callback:()=>{this.prepare_frame.get_filling()>=x.game_play.default_rules.filling&&(x.game_play.fields.push({field:this.prepare_frame.field,ships:this.prepare_frame.ships,airdef:[],mine:[]}),this.is_bot?(this.prepare_frame.clear(),this.random_bot_field(),x.game_play.fields.push({field:this.prepare_frame.field,ships:this.prepare_frame.ships,airdef:x.game_play.advanced?[0,1,2,3]:[],mine:[]}),x.game_play.advanced?u.game_play.update_scenes("prepare_arsenal"):u.game_play.update_scenes("game_play")):x.game_play.fields.length<2?(this.prepare_frame.clear(),this.done_icon.visible=!1,u.game_play.update_scenes("prepare_field")):(this.prepare_frame.clear(),this.done_icon.visible=!1,u.game_play.update_scenes("game_play")))}}),s=new(a().GameObjects.Text)(this.scene,0,0,"BATTLE",{fontFamily:"rubik",fontSize:64}),s.setOrigin(.5),this.play_button.add(s),this.add(this.play_button),this.update_buttons()}init(e){let t=1*x.cell_width;this.create_back(),this.done_icon=new(a().GameObjects.Image)(this.scene,22*t,9*t,"game_play","done_icon"),this.add(this.done_icon);let i=new(a().GameObjects.Image)(this.scene,8*t,3.5*t+2,"new","plank");i.scale=10*t/i.width,this.add(i);let s=new(a().GameObjects.Text)(this.scene,8*t,3.5*t+2,"SEA MAP",{fontFamily:"rubik",fontSize:36});s.setOrigin(.5),this.add(s),i=new(a().GameObjects.Image)(this.scene,21*t,3.5*t+2,"new","plank"),i.scale=10*t/i.width,this.add(i),s=new(a().GameObjects.Text)(this.scene,21*t,3.5*t+2,"SHIPS",{fontFamily:"rubik",fontSize:36}),s.setOrigin(.5),this.add(s),this.create_field(t),this.prepare_frame=new U,this.create_drop_zone(1,t),this.create_fantoms_ships(1,t),this.create_ships(1,t),this.create_buttons(1,t)}handler_close(){this.clear_fantoms(),this.prepare_frame.clear(),this.clear_ships()}create_field(e){let t;this.field_frame=new(a().GameObjects.Graphics)(this.scene),this.field_frame.fillStyle(16777215,0);let i,s=3*e,n=5*e,o=10*e,l=10*e;this.field_frame.fillRect(s,n,o,l),this.add(this.field_frame),t=new(a().GameObjects.Image)(this.scene,8*e,10*e,"new","field_frame"),t.scale=1.02,this.add(t),["A","B","C","D","E","F","G","H","I","J"].forEach(((t,s)=>{i=new(a().GameObjects.Text)(this.scene,2.5*e,5.5*e+e*s,t,{fontFamily:"rubik",fontSize:36,color:"#051F79"}),i.setOrigin(.5),this.add(i),i=new(a().GameObjects.Text)(this.scene,3.5*e+e*s,4.5*e,s.toString(),{fontFamily:"rubik",fontSize:36,color:"#051F79"}),i.setOrigin(.5),this.add(i)}))}}class Y extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.cell_width=x.cell_width,this.create_back(),this.create_interface(),this.create_scenes()}create_back(){this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(0,0,y.width,y.height),this.add(this.bg);let e=Math.ceil(y.height/this.cell_width),t=Math.ceil(y.width/this.cell_width);this.bg.lineStyle(2,6386084,.7);for(let t=0;t<=e;t++)this.bg.lineBetween(0,t*this.cell_width,y.width,t*this.cell_width);for(let e=0;e<=t;e++)this.bg.lineBetween(e*this.cell_width,0,e*this.cell_width,y.height);this.bg.lineStyle(7,13582392,.9),this.bg.lineBetween(0,3*this.cell_width,y.width,3*this.cell_width)}create_scenes(){this.game_play=new N(this.scene,{}),this.prepare_field=new V(this.scene,{}),this.prepare_arsenal=new X(this.scene,{}),this.add([this.game_play,this.prepare_field,this.prepare_arsenal]),this.update_scenes("prepare_field")}update_scenes(e){const t={prepare_field:this.prepare_field,prepare_arsenal:this.prepare_arsenal,game_play:this.game_play};let i=!1;Object.keys(t).forEach((s=>{i=s===e,t[s]&&t[s].visible&&!i?(this.bringToTop(t[s]),t[s].visible=i,t[s].handler_close()):t[s]&&(t[s].clearMask(),t[s].visible=i),i&&t[s].show()}))}create_interface(){let e;this.home_button=new j(this.scene,{x:6.5*this.cell_width,y:1.5*this.cell_width,atlas:"new",frame_out:"plank",callback:()=>{u.update_scenes("game_menu"),this.prepare_field.handler_close()}}),this.home_button.out_img.setScale(.65,1),e=new(a().GameObjects.Image)(this.scene,-4*this.cell_width,0,"game_play","back_icon"),this.home_button.add(e);let t=new(a().GameObjects.Text)(this.scene,0,0,"MAIN MENU",{fontFamily:"rubik",fontSize:36});t.setOrigin(.5),this.home_button.add(t),this.add(this.home_button)}}class H extends a().GameObjects.Container{constructor(e){super(e)}init(){this.bg=new(a().GameObjects.Image)(this.scene,0,0,"basic_window_bg"),this.add(this.bg),this.close_button=new j(this.scene,{x:y.width/2-200,y:100,frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button)}pre_show(e){}post_show(){}handler_close(){u.windows_manager.close_window()}}class $ extends a().GameObjects.Container{constructor(e){super(e)}create_dark(){this.dark=new(a().GameObjects.Graphics)(this.scene),this.dark.fillStyle(2302767,.6),this.dark.fillRect(-y.width/2,-y.height/2,y.width,y.height),this.dark.setInteractive(),this.dark.on("pointerup",this.handler_close),this.add(this.dark)}create_bg(){let e,t=x.cell_width+2;this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(4*t-y.width/2,2*t-y.height/2,20*t,11*t),this.bg.setInteractive(),this.bg.lineStyle(2,6386084,.7);for(let e=2;e<=12;e++)this.bg.lineBetween(4*t-y.width/2,e*t-y.height/2,24*t-y.width/2,e*t-y.height/2);for(let e=4;e<=23;e++)this.bg.lineBetween(e*t-y.width/2,2*t-y.height/2,e*t-y.width/2,13*t-y.height/2);this.bg.lineStyle(12,467577,1),this.bg.strokeRect(4*t-y.width/2+6,2*t-y.height/2+6,20*t-12,11*t-12),this.add(this.bg),e=new(a().GameObjects.Image)(this.scene,5,-5.32*t,"new","plank"),e.scaleX=1.9,this.add(e)}create_interface(){let e,t,i,s=x.cell_width+2;this.close_button=new j(this.scene,{x:9.1*s,y:-5.1*s,atlas:"game_play",frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button),t=new(a().GameObjects.Text)(this.scene,5,-5.3*s,"RESULT OF THE BATTLE",{fontFamily:"rubik",fontSize:"36"}),t.setOrigin(.5),this.add(t),this.result_plank=new(a().GameObjects.Container)(this.scene,5,-3.9*s),e=new(a().GameObjects.Image)(this.scene,0,0,"new","plank"),e.setScale(.4,.8),this.result_plank.add(e),t=new(a().GameObjects.Text)(this.scene,0,0,"WINNER",{fontFamily:"rubik",fontSize:"28"}),t.setOrigin(.5),this.result_plank.add(t),this.add(this.result_plank),e=new(a().GameObjects.Image)(this.scene,5,-3.9*s,"new","micro_plank"),e.setScale(5.5,1.5),this.add(e),t=new(a().GameObjects.Text)(this.scene,5,-3.9*s,"BATTLE IS OVER!",{fontFamily:"rubik",fontSize:"36"}),t.setOrigin(.5),this.add(t),e=new(a().GameObjects.Image)(this.scene,5,-2.33*s,"new","plank"),e.setScale(.57,1),this.add(e),t=new(a().GameObjects.Text)(this.scene,5,-2.33*s,"REWARD!",{fontFamily:"rubik",fontSize:"28"}),t.setOrigin(.5),this.add(t),e=new(a().GameObjects.Image)(this.scene,5,1*s,"game_play","chest_opened"),e.setScale(2),this.add(e),t=new(a().GameObjects.Text)(this.scene,5,.2*s,"+0 $",{fontFamily:"rubik",fontSize:"48"}),t.setOrigin(.5),this.add(t),i=new j(this.scene,{x:5,y:4*s,atlas:"new",frame_out:"lightblue_button",callback:()=>{}}),i.alpha=.7,t=new(a().GameObjects.Text)(this.scene,0,0,"+100 $",{fontFamily:"rubik",fontSize:"36"}),t.setOrigin(.5),i.add(t),this.add(i),i=new j(this.scene,{x:-6.2*s,y:4*s,atlas:"new",frame_out:"blue_button",callback:()=>{}}),i.alpha=.7,t=new(a().GameObjects.Text)(this.scene,0,0,"REMATCH",{fontFamily:"rubik",fontSize:"36"}),t.setOrigin(.5),i.add(t),this.add(i),i=new j(this.scene,{x:6.2*s,y:4*s,atlas:"new",frame_out:"red_button",callback:()=>{}}),i.alpha=.7,t=new(a().GameObjects.Text)(this.scene,0,0,"NEXT",{fontFamily:"rubik",fontSize:"36"}),t.setOrigin(.5),i.add(t),this.add(i),e=new(a().GameObjects.Image)(this.scene,-6.2*s,-1.5*s,"new","profile_ava"),this.add(e),e=new(a().GameObjects.Image)(this.scene,-6.2*s,1*s,"new","plank"),e.setScale(.4,1),this.add(e),t=new(a().GameObjects.Text)(this.scene,-6.2*s,1*s,x.user_data.name.toUpperCase(),{fontFamily:"rubik",fontSize:"28"}),t.setOrigin(.5),this.add(t),e=new(a().GameObjects.Image)(this.scene,-6.2*s,2*s,"new","plank"),e.setScale(.4,1),this.add(e),t=new(a().GameObjects.Text)(this.scene,-6.2*s,2*s,x.user_data.rank.stage.toUpperCase(),{fontFamily:"rubik",fontSize:"28"}),t.setOrigin(.5),this.add(t),e=new(a().GameObjects.Image)(this.scene,6.4*s,-1.5*s,"new","profile_ava"),e.setFlipX(!0),this.add(e),e=new(a().GameObjects.Image)(this.scene,6.4*s,1*s,"new","plank"),e.setScale(.4,1),this.add(e),t=new(a().GameObjects.Text)(this.scene,6.4*s,1*s,"Bot".toUpperCase(),{fontFamily:"rubik",fontSize:"28"}),t.setOrigin(.5),this.add(t),e=new(a().GameObjects.Image)(this.scene,6.4*s,2*s,"new","plank"),e.setScale(.4,1),this.add(e),t=new(a().GameObjects.Text)(this.scene,6.4*s,2*s,x.user_data.rank.stage.toUpperCase(),{fontFamily:"rubik",fontSize:"28"}),t.setOrigin(.5),this.add(t)}init(){let e=x.cell_width+2;this.create_bg(),this.create_interface(),this.close_button=new j(this.scene,{x:24*e,y:2*e,atlas:"game_play",frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button)}pre_show(e){e&&(this.win=e.win)}post_show(){let e=x.cell_width+2;this.scene.tweens.add({targets:this.result_plank,x:(this.win?-6.2:6.4)*e,duration:500,ease:"back.out"})}handler_close(){u.windows_manager.close_window(),u.update_scenes("game_menu")}}class W extends a().GameObjects.Container{constructor(e){super(e)}create_dark(){this.dark=new(a().GameObjects.Graphics)(this.scene),this.dark.fillStyle(2302767,.6),this.dark.fillRect(0,0,y.width,y.height),this.dark.setInteractive(new(a().Geom.Rectangle)(0,0,y.width,y.height),a().Geom.Rectangle.Contains),this.dark.on("pointerup",this.handler_close)}create_bg(){let e,t=x.cell_width+2;this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(16054009,1),this.bg.fillRect(-5.4*t,-3.3*t,10.8*t,5.6*t),this.bg.lineStyle(12,467577,1),this.bg.strokeRect(-5.4*t+6,-3.3*t+6,10.8*t-12,5.6*t-12),this.bg.setInteractive(new(a().Geom.Rectangle)(-5.4*t,-3.3*t,10.8*t,5.6*t),a().Geom.Rectangle.Contains),this.add(this.bg),e=new(a().GameObjects.Image)(this.scene,-1,-2.8*t,"new","plank"),e.setScale(1.025,1),this.add(e)}init(){let e,t,i=x.cell_width+2;this.create_bg(),this.close_button=new j(this.scene,{x:4.9*i,y:-2.8*i,atlas:"game_play",frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button),e=new(a().GameObjects.Text)(this.scene,0,-2.8*i,"QUIT GAME?",{fontFamily:"rubik",fontSize:"36"}),e.setOrigin(.5),this.add(e),e=new(a().GameObjects.Text)(this.scene,0,-1*i,"The bet will be returned!",{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),e.setOrigin(.5),this.add(e),t=new j(this.scene,{x:-2.5*i,y:1*i,atlas:"new",frame_out:"blue_button",callback:()=>{this.handler_close(),u.update_scenes("game_menu")}}),this.add(t),e=new(a().GameObjects.Text)(this.scene,0,0,"YES",{fontFamily:"rubik",fontSize:"36"}),e.setOrigin(.5),t.add(e),t=new j(this.scene,{x:2.5*i,y:1*i,atlas:"new",frame_out:"blue_button",callback:()=>{this.handler_close()}}),this.add(t),e=new(a().GameObjects.Text)(this.scene,0,0,"NO",{fontFamily:"rubik",fontSize:"36"}),e.setOrigin(.5),t.add(e)}pre_show(e){}post_show(){}handler_close(){u.windows_manager.close_window()}}class q extends a().GameObjects.Container{constructor(e){super(e)}create_bg(){let e,t=x.cell_width+2;this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(9*t-y.width/2,2*t-y.height/2,10*t,13*t),this.bg.setInteractive(new(a().Geom.Rectangle)(9*t-y.width/2,2*t-y.height/2,10*t,13*t),a().Geom.Rectangle.Contains),this.bg.lineStyle(2,6386084,.7);for(let e=2;e<=14;e++)this.bg.lineBetween(9*t-y.width/2,e*t-y.height/2,19*t-y.width/2,e*t-y.height/2);for(let e=9;e<=19;e++)this.bg.lineBetween(e*t-y.width/2,2*t-y.height/2,e*t-y.width/2,15*t-y.height/2);this.add(this.bg),e=new(a().GameObjects.Image)(this.scene,7,5.32*-t,"game_play","medium_plank"),e.scale=.95,this.add(e)}create_slider(){let e,t=x.cell_width+2;this.save_slider=new S(this.scene,{width:10*t,height:12*t}),this.add(this.save_slider),this.save_slider.setXY(.3*t,.5*t,14.3*t,-9*t),this.outer_objects.push(this.save_slider.rect_mask),["atom","bomber","torpedo","fighter","radar"].forEach(((i,s)=>{e=new(a().GameObjects.Image)(this.scene,4.6*t,s*t*4+1.8*t,"skill_item"),this.save_slider.add_child(e),e.setInteractive(),e.on("pointerdown",(()=>{this.save_slider.pointer_down=!0})),e.on("pointerup",(()=>{this.save_slider.was_move&&(this.save_slider.was_move=!1),this.save_slider.pointer_down=!1})),e.on("pointerout",(()=>{this.save_slider.pointer_down=!1,this.save_slider.was_move=!1})),e.on("pointermove",(e=>{this.save_slider.emit("pointermove",e)}))}))}init(){this.outer_objects=[];let e=x.cell_width+2;this.create_bg(),this.create_slider(),this.close_button=new j(this.scene,{x:4.5*e,y:-5.25*e,atlas:"game_play",frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button)}pre_show(e){}post_show(){}handler_close(){u.windows_manager.close_window()}}class K extends a().GameObjects.Container{constructor(e){super(e)}create_dark(){this.dark=new(a().GameObjects.Graphics)(this.scene),this.dark.fillStyle(2302767,.6),this.dark.fillRect(-y.width/2,-y.height/2,y.width,y.height),this.dark.setInteractive(),this.dark.on("pointerup",this.handler_close),this.add(this.dark)}create_bg(){let e,t=x.cell_width+2;this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(4*t-y.width/2,2*t-y.height/2,20*t,11*t),this.bg.setInteractive(),this.bg.lineStyle(2,6386084,.7);for(let e=2;e<=12;e++)this.bg.lineBetween(4*t-y.width/2,e*t-y.height/2,24*t-y.width/2,e*t-y.height/2);for(let e=4;e<=23;e++)this.bg.lineBetween(e*t-y.width/2,2*t-y.height/2,e*t-y.width/2,13*t-y.height/2);this.bg.lineStyle(12,467577,1),this.bg.strokeRect(4*t-y.width/2+6,2*t-y.height/2+6,20*t-12,11*t-12),this.add(this.bg),e=new(a().GameObjects.Image)(this.scene,5,-5.32*t,"new","plank"),e.scaleX=1.9,this.add(e)}create_interface(){let e,t,i,s=x.cell_width+2;this.close_button=new j(this.scene,{x:9.1*s,y:-5.1*s,atlas:"game_play",frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button),e=new(a().GameObjects.Image)(this.scene,0,-4.3*s,"new","header"),e.setScale(1),this.add(e),t=new(a().GameObjects.Text)(this.scene,0,-3.3*s,"BLACK SEA",{fontFamily:"rubik",fontSize:"48",color:"#051F79"}),t.setOrigin(.5),this.add(t);for(let i=0;i<3;i++)e=new(a().GameObjects.Image)(this.scene,6*(i-1)*s,1*s,"new","arena_item"),e.setScale(1),this.add(e),0===i?(e=new(a().GameObjects.Image)(this.scene,6*(i-1)*s,1*s,"new","chest_mini"),e.setScale(1),this.add(e),t=new(a().GameObjects.Text)(this.scene,6*(i-1)*s,-.5*s,"REWARD",{fontFamily:"rubik",fontSize:"36"}),t.setOrigin(.5),this.add(t),t=new(a().GameObjects.Text)(this.scene,6*(i-1)*s,2*s,"0 $",{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),t.setOrigin(.5),this.add(t)):1===i?(e=new(a().GameObjects.Image)(this.scene,6*(i-1)*s,1*s,"new","home_icon"),e.setScale(1),this.add(e),t=new(a().GameObjects.Text)(this.scene,6*(i-1)*s,-.5*s,"OPEN BULDING",{fontFamily:"rubik",fontSize:"36"}),t.setOrigin(.5),this.add(t),t=new(a().GameObjects.Text)(this.scene,6*(i-1)*s,2*s,"0/0",{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),t.setOrigin(.5),this.add(t)):2===i&&(e=new(a().GameObjects.Image)(this.scene,6*(i-1)*s,1*s,"new","ticket_icon"),e.setScale(1),this.add(e),t=new(a().GameObjects.Text)(this.scene,6*(i-1)*s,-.5*s,"ENTRY STAKE",{fontFamily:"rubik",fontSize:"36"}),t.setOrigin(.5),this.add(t),t=new(a().GameObjects.Text)(this.scene,6*(i-1)*s,2*s,"0 $",{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),t.setOrigin(.5),this.add(t));let n=new(a().GameObjects.Arc)(this.scene,-7.3*s,6*s,20,0,360,!1,3202566,1);n.setStrokeStyle(5,7269,1);let o=new(a().GameObjects.Arc)(this.scene,1.8*s,6*s,20,0,360,!1,7269,1);o.setStrokeStyle(5,7269,1),e=new(a().GameObjects.Image)(this.scene,-4.5*s,6*s,"new","big_blue_button"),e.alpha=1,e.setInteractive(),e.on("pointerup",(()=>{o.setFillStyle(7269,1),n.setFillStyle(3202566,1),x.game_play.advanced=!0})),this.add(e),this.add(n),t=new(a().GameObjects.Text)(this.scene,-4.5*s,6*s,"ADVANCED MODE",{fontFamily:"rubik",fontSize:"36"}),t.alpha=1,t.setOrigin(.5),this.add(t),e=new(a().GameObjects.Image)(this.scene,4.5*s,6*s,"new","big_blue_button"),e.alpha=1,e.setInteractive(),e.on("pointerup",(()=>{n.setFillStyle(7269,1),o.setFillStyle(3202566,1),x.game_play.advanced=!1})),this.add(e),this.add(o),t=new(a().GameObjects.Text)(this.scene,4.5*s,6*s,"CLASSIC MODE",{fontFamily:"rubik",fontSize:"36"}),t.alpha=1,t.setOrigin(.5),this.add(t),i=new j(this.scene,{x:0,y:4*s,atlas:"new",frame_out:"red_button",callback:()=>{this.handler_close(),u.update_scenes("game_play")}}),t=new(a().GameObjects.Text)(this.scene,0,0,"PLAY",{fontFamily:"rubik",fontSize:"36"}),t.setOrigin(.5),i.add(t),this.add(i)}init(){let e=x.cell_width+2;this.create_bg(),this.create_interface(),this.close_button=new j(this.scene,{x:24*e,y:2*e,atlas:"game_play",frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button)}pre_show(e){e&&(this.win=e.win)}post_show(){x.cell_width}handler_close(){u.windows_manager.close_window(),u.update_scenes("game_menu")}}class J extends a().GameObjects.Container{constructor(e){super(e)}create_bg(){let e,t=x.cell_width+2;this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(9*t-y.width/2,2*t-y.height/2,10*t,13*t),this.bg.setInteractive(new(a().Geom.Rectangle)(9*t-y.width/2,2*t-y.height/2,10*t,13*t),a().Geom.Rectangle.Contains),this.bg.lineStyle(2,6386084,.7);for(let e=2;e<=14;e++)this.bg.lineBetween(9*t-y.width/2,e*t-y.height/2,19*t-y.width/2,e*t-y.height/2);for(let e=9;e<=19;e++)this.bg.lineBetween(e*t-y.width/2,2*t-y.height/2,e*t-y.width/2,15*t-y.height/2);this.add(this.bg),e=new(a().GameObjects.Image)(this.scene,7,5.32*-t,"game_play","medium_plank"),e.scale=.95,this.add(e)}create_slider(){let e,t=x.cell_width+2;this.arsenal_slider=new S(this.scene,{width:10*t,height:12*t}),this.add(this.arsenal_slider),this.arsenal_slider.setXY(.3*t,.5*t,14.3*t,-9*t),this.outer_objects.push(this.arsenal_slider.rect_mask),["atom","bomber","torpedo","fighter","submarine","radar"].forEach(((i,s)=>{e=new(a().GameObjects.Image)(this.scene,4.6*t,s*t*4+1.8*t,"skill_item"),this.arsenal_slider.add_child(e),e.setInteractive(),e.on("pointerdown",(()=>{this.arsenal_slider.pointer_down=!0})),e.on("pointerup",(()=>{!this.arsenal_slider.was_move&&x.user_data.skills[i].amount>0?(this.start_skill(i),this.handler_close()):this.arsenal_slider.was_move=!1,this.arsenal_slider.pointer_down=!1})),e.on("pointerout",(()=>{this.arsenal_slider.pointer_down=!1,this.arsenal_slider.was_move=!1})),e.on("pointermove",(e=>{this.arsenal_slider.emit("pointermove",e)})),e=new(a().GameObjects.Image)(this.scene,e.x,e.y+25,"skill_"+i),this.arsenal_slider.add_child(e),e=new(a().GameObjects.Text)(this.scene,e.x-230,e.y+50,`${x.user_data.skills[i].amount}/${x.skills[i].max}`,{fontFamily:"rubik",fontSize:"36",color:"#072279"}),e.setOrigin(.5,.5),this.arsenal_slider.add_child(e)}))}start_skill(e){u.game_play.game_play.start_skill(e)}init(){this.outer_objects=[];let e=x.cell_width+2;this.create_bg(),this.create_slider(),this.close_button=new j(this.scene,{x:4.5*e,y:-5.25*e,atlas:"game_play",frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button)}pre_show(e){}post_show(){}handler_close(){u.windows_manager.close_window()}}class Q extends a().GameObjects.Container{constructor(e){super(e)}create_dark(){this.dark=new(a().GameObjects.Graphics)(this.scene),this.dark.fillStyle(2302767,.6),this.dark.fillRect(0,0,y.width,y.height),this.dark.setInteractive(new(a().Geom.Rectangle)(0,0,y.width,y.height),a().Geom.Rectangle.Contains),this.dark.on("pointerup",this.handler_close)}create_bg(){let e,t=x.cell_width+2;this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(16054009,1),this.bg.fillRect(-5.4*t,-3.3*t,10.8*t,5.6*t),this.bg.lineStyle(12,467577,1),this.bg.strokeRect(-5.4*t+6,-3.3*t+6,10.8*t-12,5.6*t-12),this.bg.setInteractive(new(a().Geom.Rectangle)(-5.4*t,-3.3*t,10.8*t,5.6*t),a().Geom.Rectangle.Contains),this.add(this.bg),e=new(a().GameObjects.Image)(this.scene,-1,-2.8*t,"new","plank"),e.setScale(1.025,1),this.add(e)}init(){let e,t,i,s=x.cell_width+2;this.create_bg(),this.close_button=new j(this.scene,{x:4.9*s,y:-2.8*s,atlas:"game_play",frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button),e=new(a().GameObjects.Text)(this.scene,0,-2.8*s,"FUEL DELIVERY!",{fontFamily:"rubik",fontSize:36}),e.setOrigin(.5),this.add(e),t=new(a().GameObjects.Image)(this.scene,0,-1.3*s,"new","oil_icon_dark"),t.scale=2,this.add(t),e=new(a().GameObjects.Text)(this.scene,0,0*s,"+600",{fontFamily:"rubik",fontSize:64,color:"#051F79"}),e.setOrigin(.5),this.add(e),i=new j(this.scene,{x:0,y:1.3*s,atlas:"new",frame_out:"lightblue_button",callback:()=>{x.user_data.oil.amount+=600,x.user_data.oil.amount>x.user_data.oil.max&&(x.user_data.oil.amount=x.user_data.oil.max),u.game_play.prepare_arsenal.update_oil(),this.handler_close()}}),this.add(i),e=new(a().GameObjects.Text)(this.scene,0,0,"CLAIM!",{fontFamily:"rubik",fontSize:36}),e.setOrigin(.5),i.add(e)}pre_show(e){}post_show(){}handler_close(){u.windows_manager.close_window()}}class Z extends a().GameObjects.Container{constructor(e){super(e)}create_dark(){this.dark=new(a().GameObjects.Graphics)(this.scene),this.dark.fillStyle(2302767,.6),this.dark.fillRect(-y.width/2,-y.height/2,y.width,y.height),this.dark.setInteractive(),this.dark.on("pointerup",this.handler_close),this.add(this.dark)}create_bg(){let e,t=x.cell_width+2;this.bg=new(a().GameObjects.Graphics)(this.scene),this.bg.fillStyle(15329507,1),this.bg.fillRect(1*t-y.width/2,1*t-y.height/2,26*t,12*t),this.bg.setInteractive(),this.bg.lineStyle(2,6386084,.7);for(let e=1;e<=13;e++)this.bg.lineBetween(1*t-y.width/2,e*t-y.height/2,27*t-y.width/2,e*t-y.height/2);for(let e=2;e<=27;e++)this.bg.lineBetween(e*t-y.width/2,1*t-y.height/2,e*t-y.width/2,13*t-y.height/2);this.bg.lineStyle(12,467577,1),this.bg.strokeRect(1*t-y.width/2+6,1*t-y.height/2+6,26*t-12,12*t-12),this.add(this.bg),e=new(a().GameObjects.Image)(this.scene,7,-6.32*t,"new","plank"),e.scaleX=2.46,this.add(e);let i=new(a().GameObjects.Text)(this.scene,7,-6.32*t,"DAILY REWARD",{fontFamily:"rubik",fontSize:"36",color:"#FFFFFF"});i.setOrigin(.5),this.add(i)}create_interface(){let e=x.cell_width+2;this.close_button=new j(this.scene,{x:12.1*e,y:-6.1*e,atlas:"game_play",frame_out:"close_button",frame_over:"close_button",frame_down:"close_button",callback:()=>{this.handler_close()}}),this.add(this.close_button)}create_main_prize(){let e=x.cell_width+2,t=new(a().GameObjects.Rectangle)(this.scene,-650,-5,5*e,9*e);t.setStrokeStyle(5,467577,1),this.add(t);let i=new(a().GameObjects.Image)(this.scene,-650,-150,"game_play","chest_closed");i.setScale(1.5),this.add(i);let s=new(a().GameObjects.Text)(this.scene,-650,-350,"ADMIRAL REWARD",{fontFamily:"rubik",fontSize:"32",color:"#051F79"});s.setOrigin(.5),this.add(s),s=new(a().GameObjects.Text)(this.scene,-650,18,"Log in every day and\nwin a special prize!",{fontFamily:"rubik",fontSize:"28",color:"#051F79",align:"center"}),s.setOrigin(.5),this.add(s),this.create_day_bar()}create_items(){for(let e=0;e<14;e++){let t=new(a().GameObjects.Container)(this.scene,e%7*190-370,330*Math.floor(e/7)-170),i=new(a().GameObjects.Rectangle)(this.scene,0,0,170,290);i.setStrokeStyle(9,467577,1),t.add(i);let s=new(a().GameObjects.Image)(this.scene,0,-120,"new","plank");s.setScale(.23,.8),t.add(s);let n=new(a().GameObjects.Text)(this.scene,0,-120,"DAY "+(e+1),{fontFamily:"rubik",fontSize:"28",color:"#FFFFFF"});n.setOrigin(.5),t.add(n);let o=x.daily_rewards[e];if("coins"===o.type||"gems"===o.type){let e=new(a().GameObjects.Image)(this.scene,0,0,"shop",o.icon);e.width>150&&e.setScale(150/e.width);let i=new(a().GameObjects.Text)(this.scene,0,100,String(o.amount),{fontFamily:"rubik",fontSize:"36",color:"#051F79"});i.setOrigin(.5),t.add([e,i])}this.add(t)}}create_day_bar(){let e=x.cell_width;this.day_bar=new n(this.scene,{atlas:"new",frame_bg:"plank",frame_bar:"oil_progress"}),this.day_bar.bg.setScale(.73,1),this.day_bar.update_progress((x.user_data.daily_reward.amount+1)/x.daily_rewards.length),this.day_bar.setPosition(-650,2.7*e),this.day_bar.setScale(.6,.9),this.add(this.day_bar),this.day_bar_txt=new(a().GameObjects.Text)(this.scene,-650,1.7*e,`DAY ${x.user_data.daily_reward.amount+1}/${x.daily_rewards.length}`,{fontFamily:"rubik",fontSize:"36",color:"#051F79"}),this.day_bar_txt.setOrigin(.5,.5),this.add(this.day_bar_txt)}init(){x.cell_width,this.create_bg(),this.create_interface(),this.create_items(),this.create_main_prize()}pre_show(e){}post_show(){}handler_close(){u.windows_manager.close_window()}}class ee extends a().GameObjects.Container{constructor(e){super(e)}create_dark(){this.dark=new(a().GameObjects.Graphics)(this.scene),this.dark.fillStyle(2302767,.6),this.dark.fillRect(0,0,y.width,y.height),this.dark.setInteractive(new(a().Geom.Rectangle)(0,0,y.width,y.height),a().Geom.Rectangle.Contains),this.dark.on("pointerup",this.handler_close)}create_bg(){let e,t=x.cell_width+2;e=new(a().GameObjects.Image)(this.scene,y.width/2,-2.8*t,"game_menu","settings_back"),e.x-=e.width/2,e.setInteractive(),e.setScale(1,1),this.add(e)}init(){let e,t,i=x.cell_width+2;this.create_bg(),this.close_button=new j(this.scene,{x:y.width/2-.7*i,y:-y.height/2+.7*i,atlas:"game_menu",frame_out:"icon_close",frame_over:"icon_close",frame_down:"icon_close",callback:()=>{this.handler_close()}}),this.add(this.close_button),t=new j(this.scene,{x:y.width/2-3.8*i,y:-y.height/2+2.5*i,atlas:"game_menu",frame_out:"settings_button",callback:()=>{this.handler_close(),u.big_windows.update_scenes("settings"),u.update_scenes("big_windows")}}),this.add(t),e=new(a().GameObjects.Text)(this.scene,0,0,"SETTINGS",{fontFamily:"rubik",fontSize:"36",color:"#3C2415"}),e.setOrigin(.5),t.add(e),t=new j(this.scene,{x:y.width/2-3.8*i,y:-y.height/2+4*i,atlas:"game_menu",frame_out:"settings_button",callback:()=>{this.handler_close(),u.big_windows.update_scenes("achivments"),u.update_scenes("big_windows")}}),this.add(t),e=new(a().GameObjects.Text)(this.scene,0,0,"ACHIVEMENT",{fontFamily:"rubik",fontSize:"36",color:"#3C2415"}),e.setOrigin(.5),t.add(e)}pre_show(e){}post_show(){}handler_close(){u.windows_manager.close_window()}}class te extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){this.pending_widows=[],this.window=null,this.create_window_table()}create_window_table(){this.window_table={test:H,result_battle:$,quit_battle:W,save_field:q,arsenal:J,video_oil:Q,arena_slider:K,daily_reward:Z,options:ee}}show_window(e,t){let i=!1,s=e||"",a=t;if(!this.window&&0===this.pending_widows.length&&s in this.window_table)this.window=new this.window_table[s](this.scene),i=!0;else if(this.window)this.pending_widows.push({window_id:e,current_params:a});else{let{window_id:e,params:t}=this.pending_widows.shift();s=e,a=t,this.window=new this.window_table[s](this.scene),i=!0}i&&this.window&&(this.window.x=y.width/2,this.window.y=-y.height/2,this.add(this.window),this.window.init(),this.window.pre_show(a),this.anim_pos_window(y.height/2,(()=>{var e;null===(e=this.window)||void 0===e||e.post_show()})))}anim_pos_window(e,t){var i;let s=e>y.height/2?"back.in":"back.out";this.scene.tweens.add({targets:this.window,y:e,duration:400,ease:s,onComplete:()=>t()}),(null===(i=this.window)||void 0===i?void 0:i.outer_objects)&&this.window.outer_objects.forEach((t=>{var i;this.scene.tweens.add({targets:(null===(i=this.window)||void 0===i?void 0:i.outer_objects)||[],y:e<=y.height/2?e-y.height/2-t.y:e,duration:400,ease:s})})),this.scene.tweens.add({targets:u.dark,alpha:e>y.height/2?0:1,duration:300})}close_window(){this.anim_pos_window(1.5*y.height,(()=>{this.window&&this.window.destroy(),this.window=null,this.pending_widows.length>0&&this.show_window()}))}}class ie extends a().GameObjects.Container{constructor(e){super(e),this.init()}init(){}get_big_window_move_anim(e,t=(()=>{})){const i=new(a().Display.BaseShader)("BufferShader",'\n/*\n * Original shader from: https://www.shadertoy.com/view/ltdXzX\n */\n\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\n// glslsandbox uniforms\nuniform sampler2D iChannel0;\nuniform float time;\nuniform vec2 resolution;\n\n// shadertoy globals\n#define iTime time\n#define iResolution resolution\n\n// --------[ Original ShaderToy begins here ]---------- //\n/*\n"Page Turning" by Emmanuel Keller aka Tambako - December 2015\nLicense Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\nContact: tamby@tambako.ch\n*/\n\nconst float pi = 3.14159;\nconst float twopi = 6.28319;\n\nconst float e0 = 0.018;\nconst float ppow = 2.0;\n\nconst float bcolorMix = 0.67;\nconst float maxBcolVal = 0.4;\n\nconst float diffint = 1.2;\nconst float ambientt = 0.1;\nconst float ambientb = 0.4;\n\nconst vec2 specpos = vec2(0.85, -0.2);\nconst float specpow = 5.;\nconst float specwidth = 0.4;\nconst float specint = 0.6;\n\nconst vec2 shadowoffset = vec2(0.07, -0.04);\nconst float shadowsmoothness = 0.012;\nconst float shadowint = 0.25;\n\nconst float aawidth = 0.7;\nconst int aasamples = 3;\n\nconst bool showpoints = false;\nconst bool colors = false;\nconst bool anim = true;\n\n#define swap_x\n\n// Simple "random" function\nfloat random(float co)\n{\n    return fract(sin(co*12.989) * 43758.545);\n}\n\nvec4 getPagebackColor()\n{\n    \n    float cn = 1.0;\n    vec4 pagebackColor;\n    pagebackColor.r = maxBcolVal*random(cn + 263.714);\n    pagebackColor.g = maxBcolVal*random(cn*4. - 151.894);\n    pagebackColor.b = maxBcolVal*random(cn*7. + 87.548);\n    pagebackColor.a = 0.0;\n    return pagebackColor;\n}\n\nvec2 rotateVec(vec2 vect, float angle)\n{\n    float xr = vect.x*cos(angle) + vect.y*sin(angle);\n    float yr = vect.x*sin(angle) - vect.y*cos(angle);\n    return vec2(xr, yr);\n}\n\n// Curl function on the axis bottom left corner - corner of the sheet\nfloat pageFunction(float x, float e)\n{\n    return pow(pow(x, ppow) - e, 1./ppow);\n}\n\n// Derivate of the curl function for light calculations\nfloat pageFunctionDer(float x, float e)\n{\n    return pow(x, ppow - 1.)/pow(pow(x, ppow) - e, (ppow - 1.)/ppow);\n}\n\nvec4 turnPage(vec2 fragCoord)\n{\n\t// General calculations\n    vec2 uv = fragCoord.xy / iResolution.yy;\n    float ratio = iResolution.x/iResolution.y;\n    \n    // As long as one doesn\'t click on the canvas, the animation runs\n    vec2 mpoint;\n    bool firstcycle;\n    \n    \n    firstcycle = mod(iTime/3.5, 2.)<1.;\n    mpoint = vec2(mod(iTime/3.5, 1.)*iResolution.x*2.0, pow(mod(iTime/3.5, 1.), 2.5)*iResolution.y/1.2 + 8.*smoothstep(0., 0.07, mod(iTime/3.5, 1.)));\n   \n    vec2 midmpoint = mpoint*0.5;\n    float mdist = distance(fragCoord, mpoint);\n    float e = e0*pow(mdist/iResolution.y, 2.) + 0.02*e0*smoothstep(0., 0.12, mdist/iResolution.y);\n    float angle = - atan(mpoint.x/mpoint.y) + pi*0.5;\n    \n    vec2 uv2 = uv;\n    #ifdef swap_x\n    uv2.x = ratio - uv2.x;\n    #endif\n    \n    vec2 uvr = rotateVec(uv2 - midmpoint/iResolution.yy, angle);\n    \n    float pagefunc = pageFunction(uvr.x, e);\n    vec2 uvr2 = vec2(pagefunc, uvr.y); \n    vec2 uvr3 = rotateVec(uvr2, -angle) - vec2(1., -1.)*midmpoint/iResolution.yy;\n    \n    vec2 uvr2b = vec2(-pagefunc, uvr.y); \n    vec2 uvr3b = rotateVec(uvr2b, -angle) - vec2(1., -1.)*midmpoint/iResolution.yy;\n    \n    #ifdef swap_x\n    uvr3b.x = ratio - uvr3b.x;\n    #endif\n        \n    vec4 i; \n    // Turned page\n    if (uvr.x>0. && uvr3b.y>0.)\n    {\n        vec2 uvcorr = vec2(ratio, 1.);\n        vec2 uvrcorr = rotateVec(uvcorr - midmpoint/iResolution.yy, angle);\n        float pagefunccorr = pageFunction(uvrcorr.x, e);\n        vec2 uvrcorr2 = vec2(-pagefunccorr, uvrcorr.y); \n        vec2 uvrcorr3 = rotateVec(uvrcorr2, -angle) - vec2(1., -1.)*midmpoint/iResolution.yy;\n    \n        float pagefuncder = pageFunctionDer(uvr.x, e);\n        float intfac = 1. - diffint*(1. - 1./pagefuncder);\n\n        if(uvr3.x>=0. || uvr3.y<=0.)\n        {\n            // Top of the turned page           \n        \tfloat mdists = distance(fragCoord, mpoint)*0.7 - 55.;\n        \tfloat es = e0*pow(mdists/iResolution.y, 2.) + 0.02*e0*smoothstep(0., 0.08, mdist/iResolution.y);\n        \tvec2 uvrs = rotateVec(uv2 - midmpoint/iResolution.yy - shadowoffset, angle);\n        \tfloat pagefuncs = pageFunction(uvrs.x + 0.015, es - 0.001);\n        \tvec2 uvr2s = vec2(pagefuncs, uvrs.y); \n        \tvec2 uvr3s = rotateVec(uvr2s, -angle) - vec2(1., -1.)*midmpoint/iResolution.yy;\n        \tfloat shadow = 1. - (1. - smoothstep(-shadowsmoothness, shadowsmoothness, uvr3s.x))*(1. - smoothstep(shadowsmoothness, -shadowsmoothness, uvr3s.y));\n            \n            float difft = intfac*(1. - ambientt) + ambientt;\n        \tdifft = difft*(shadow*shadowint + 1. - shadowint)/2. + mix(1. - shadowint, difft, shadow)/2.;\n            if (firstcycle)\n                //i = difft*(colors?vec4(1., 0.3, 0.3, 1.):texture2D(iChannel0, mod((uvr3b - uvrcorr3)/vec2(-ratio, 1.), 1.)));\n                i = vec4(0.0, 0.0, 0.0, 0.0);\n            else\n                //i = difft*(colors?vec4(1., 0.3, 0.3, 1.):texture2D(iChannel0, mod((uvr3b - uvrcorr3)/vec2(-ratio, 1.), 1.)));\n                i = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n        else\n        {\n            // Bottom of the turned page\n            float diffb = intfac*(1. - ambientb) + ambientb;\n        \tfloat spec = pow(smoothstep(specpos.x - 0.35, specpos.x, intfac)*smoothstep(specpos.x + 0.35, specpos.x, intfac), specpow);\n        \tspec*= specint*pow(1. - pow(clamp(abs(uvr.y - specpos.y), 0., specwidth*2.), 2.)/specwidth, specpow);\n\t\t\t/*if (firstcycle)\n                i = diffb*(colors?vec4(0.3, 1.0, 0.3, 1.):mix(texture2D(iChannel0, mod((uvr3 - uvrcorr3)/vec2(-ratio, 1.), 1.)), getPagebackColor(), bcolorMix));\n            else\n                i = diffb*(colors?vec4(0.3, 1.0, 0.3, 1.):mix(texture2D(iChannel0, mod((uvr3 - uvrcorr3)/vec2(-ratio, 1.), 1.)), getPagebackColor(), bcolorMix));\n            */\n            i = diffb*(colors?vec4(0.3, 1.0, 0.3, 1.):texture2D(iChannel0, mod((uvr3 - uvrcorr3)/vec2(-ratio, 1.), 1.)));\n         \t// i = mix(i, vec4(1.0), spec);\n            \n        }\n    }\n    else\n    {\n        // "Background" with simple shadow\n\n        vec2 mpointbg = vec2(0.2, 0.01);\n        vec2 midmpointbg = mpointbg*0.5;\n        float mdistbg = distance(fragCoord, mpointbg);\n        float ebg = e0*pow(mdistbg/iResolution.y, 2.) + 0.01*e0*smoothstep(0., 0.12, mdistbg/iResolution.y);\n        float anglebg = 0.001; //- atan(mpointbg.x/mpointbg.y) + pi*0.5;\n        vec2 uvrbg = rotateVec(uv - midmpointbg/iResolution.yy, anglebg);\n        //float pagefuncbg = mix(uvrbg.x, pageFunction(uvrbg.x, ebg), clamp(uvrbg.x*5., 0., 1.));\n        float pagefuncbg;\n        if (uvrbg.x<0.15)\n           pagefuncbg = uvrbg.x;\n        else\n           pagefuncbg = mix(uvrbg.x, pageFunction(uvrbg.x, ebg), smoothstep(mpoint.x/iResolution.x + 0.1, mpoint.x/iResolution.x, uvrbg.x));\n        \n        vec2 uvr2bbg = vec2(-pagefuncbg, uvrbg.y); \n        vec2 uvr3bbg = rotateVec(uvr2bbg, -anglebg) - vec2(1., -1.)*midmpointbg/iResolution.yy;\n        vec2 uvcorrbg = vec2(ratio, 1.);\n        vec2 uvrcorrbg = rotateVec(uvcorrbg - midmpointbg/iResolution.yy, anglebg);\n        float pagefunccorrbg = pageFunction(uvrcorrbg.x, ebg);\n        vec2 uvrcorr2bg = vec2(-pagefunccorrbg, uvrcorrbg.y); \n        vec2 uvrcorr3bg = rotateVec(uvrcorr2bg, -anglebg) - vec2(1., -1.)*midmpointbg/iResolution.yy;       \n        float pagefuncderbg = pageFunctionDer(uvrbg.x, ebg);\n        float intfacbg = 1. - diffint*(1. - 1./pagefuncderbg);\n        float difftbg = intfacbg*(1. - ambientt) + ambientt;\n        \n        if (firstcycle) \n            //i = colors?difftbg*vec4(0.3, 0.3, 1., 1.):texture2D(iChannel0, mod((uvr3bbg - uvrcorr3bg)/vec2(-ratio, 1.), 1.));\n            i = vec4(0.0, 0.0, 0.0, 0.0);\n        else\n            //i = colors?difftbg*vec4(0.3, 0.3, 1., 1.):texture2D(iChannel0, mod((uvr3bbg - uvrcorr3bg)/vec2(-ratio, 1.), 1.));\n            i = vec4(0.0, 0.0, 0.0, 0.0);\n        float bgshadow = 1. + shadowint*smoothstep(-0.08+shadowsmoothness*4., -0.08, uvr3b.y) - shadowint;\n        \n        if (uvr3b.y<0.)\n           i*= bgshadow;\n    }\n    return i;\n}\n \nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    // Antialiasing\n    vec4 vs = vec4(0.);\n    for (int j=0;j<aasamples ;j++)\n    {\n       float oy = float(j)*aawidth/max(float(aasamples-1), 1.);\n       for (int i=0;i<aasamples ;i++)\n       {\n          float ox = float(i)*aawidth/max(float(aasamples-1), 1.);\n          vs+= turnPage(fragCoord + vec2(ox, oy));\n       }\n    }\n    vec4 i = vs/vec4(aasamples*aasamples);    \n    \n    // Show the mouse points. Was only used for development\n    vec4 ocol; \n    if (showpoints)\n    {\n        float ratio = iResolution.x/iResolution.y;\n        vec2 mpoint = vec2(0.0, 0.0);\n        vec2 midmpoint = mpoint*0.5;\n        float mdist = distance(fragCoord, mpoint);\n        float midmdist = distance(fragCoord, midmpoint);\n        \n        ocol = mix(i, vec4(1., 0., 0., 1.), smoothstep(6., 4., mdist));\n        ocol = mix(ocol, vec4(1., 1., 0., 1.), smoothstep(6., 4., midmdist));\n    }\n    else\n        ocol = i;\n        \n    fragColor = i;\n}\n// --------[ Original ShaderToy ends here ]---------- //\n\nvoid main(void)\n{\n    mainImage(gl_FragColor, gl_FragCoord.xy);\n}\n');this.scene.add.shader(i,y.width/2,y.height/2,1.2*y.width,1.2*y.height).setUniform("iChannel0",this.scene.textures.get("page_bg").getSourceImage())}}class se{constructor(e){this.scene=e,this.lang=this.get_user_lang(),this.global_texts=[],this.loaded_languages={},this.load_lang((()=>{this.update_texts()}))}load_lang(e){this.lang in this.loaded_languages?e():(this.scene.load.json(this.lang,"public/assets/lang/"+this.lang+".json"),this.scene.load.once("complete",(()=>{this.loaded_languages[this.lang]=!0,e()})),this.scene.load.start())}set_language(e){this.lang=e,this.load_lang((()=>{this.update_user_lang(),this.update_texts()}))}get_user_lang(){return"en_US"}update_user_lang(){console.log("to server",this.lang)}get_text_for_id(e){let t;return this.lang in this.loaded_languages?t=this.scene.cache.json.get(this.lang):this.load_lang((()=>{t=this.scene.cache.json.get(this.lang)})),t[e]}update_text(e){let t;e.text_object.lang!==this.lang&&(t=this.get_text_for_id(e.text_id),e.text_object.lang=this.lang,e.text_object.setText(t.text),e.text_object.setStyle(t.style))}update_texts(){this.global_texts.forEach((e=>{this.update_text(e)}))}add_text(e,t){let i={text_object:e,text_id:t};this.global_texts.push(i),this.update_text(i)}}class ae extends a().GameObjects.Container{constructor(e){super(e)}init_flags(){x.flags=Object.keys(this.scene.textures.get("flags").frames).filter((e=>"__BASE"!==e)),console.log(x.flags)}create_dark(){this.dark=new(a().GameObjects.Graphics)(this.scene),this.dark.fillStyle(2302767,.6),this.dark.fillRect(0,0,y.width,y.height),this.dark.setInteractive(new(a().Geom.Rectangle)(0,0,y.width,y.height),a().Geom.Rectangle.Contains),this.dark.on("pointerup",(()=>{this.windows_manager.window&&this.windows_manager.window.handler_close?this.windows_manager.window.handler_close():this.windows_manager.close_window()})),this.dark.alpha=0,this.add(this.dark)}init(){this.init_flags(),this.anims_manager=new ie(this.scene),this.add(this.anims_manager),this.language_manager=new se(this.scene),this.game_menu=new P(this.scene),this.add(this.game_menu),this.game_play=new Y(this.scene),this.add(this.game_play),this.big_windows=new A(this.scene),this.add(this.big_windows),this.create_dark(),this.windows_manager=new te(this.scene),this.add(this.windows_manager),this.update_scenes("game_menu")}update_scenes(e){const t={game_menu:this.game_menu,game_play:this.game_play,big_windows:this.big_windows};let i=!1;Object.keys(t).forEach((s=>{i=s===e,t[s]&&(t[s].visible=i)}))}to_local_pt(e,t){var i,s=[],n=e;if(t)var o=new(a().Geom.Point)(t.x,t.y);else o=new(a().Geom.Point)(0,0);for(;n&&!(n instanceof a().Scene);)s.push(n),n=n.parentContainer;for(;s.length>0;)i=s.pop(),o.x=(o.x-i.x)/i.scaleX,o.y=(o.y-i.y)/i.scaleY;return o}to_global_pt(e,t){if(t)var i=new(a().Geom.Point)(t.x,t.y);else i=new(a().Geom.Point)(0,0);for(var s=e;s&&s!=this.scene;)i.x=i.x*s.scaleX+s.x,i.y=i.y*s.scaleY+s.y,s=s.parentContainer,console.trace(i,s);return i}}},204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},i={};function s(e){var a=i[e];if(void 0!==a)return a.exports;var n=i[e]={exports:{}};return t[e].call(n.exports,n,n.exports,s),n.exports}s.m=t,e=[],s.O=(t,i,a,n)=>{if(!i){var o=1/0;for(c=0;c<e.length;c++){for(var[i,a,n]=e[c],l=!0,h=0;h<i.length;h++)(!1&n||o>=n)&&Object.keys(s.O).every((e=>s.O[e](i[h])))?i.splice(h--,1):(l=!1,n<o&&(o=n));if(l){e.splice(c--,1);var r=a();void 0!==r&&(t=r)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[i,a,n]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};s.O.j=t=>0===e[t];var t=(t,i)=>{var a,n,[o,l,h]=i,r=0;if(o.some((t=>0!==e[t]))){for(a in l)s.o(l,a)&&(s.m[a]=l[a]);if(h)var c=h(s)}for(t&&t(i);r<o.length;r++)n=o[r],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(c)},i=self.webpackChunkphaser_project_template=self.webpackChunkphaser_project_template||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),s.O(void 0,[216],(()=>s(113)));var a=s.O(void 0,[216],(()=>s(204)));a=s.O(a)})();